"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["9889"],{79783:function(e,n,r){r.r(n),r.d(n,{default:function(){return c}});var s=r(55367),i=r(26971),l=r(38146);function d(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",pre:"pre",code:"code",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",blockquote:"blockquote"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"vite",children:["Vite",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#vite",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"本章节介绍如何将 Vite 项目迁移到 Rsbuild。"}),"\n",(0,s.jsxs)(n.h2,{id:"安装依赖",children:["安装依赖",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安装依赖",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"首先你需要把 Vite 相关的 npm 依赖替换为 Rsbuild 的依赖。"}),"\n","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"移除 Vite 的依赖："}),"\n"]}),"\n",(0,s.jsx)(l.PackageManagerTabs,{command:"remove vite"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"安装 Rsbuild 的依赖："}),"\n"]}),"\n",(0,s.jsx)(l.PackageManagerTabs,{command:"add @rsbuild/core -D"}),"\n",(0,s.jsxs)(n.h2,{id:"更新-npm-scripts",children:["更新 npm scripts",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#更新-npm-scripts",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"下一步，你需要把 package.json 中的 npm scripts 更新为 Rsbuild 的 CLI 命令。"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",meta:'title="package.json"',children:'{\n  "scripts": {\n-   "dev": "vite",\n-   "build": "vite build",\n-   "preview": "vite preview"\n+   "dev": "rsbuild dev",\n+   "build": "rsbuild build",\n+   "preview": "rsbuild preview"\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"创建配置文件",children:["创建配置文件",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#创建配置文件",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["在 package.json 的同级目录下创建 Rsbuild 的配置文件 ",(0,s.jsx)(n.code,{children:"rsbuild.config.ts"}),"，并添加以下内容："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { defineConfig } from '@rsbuild/core';\n\nexport default defineConfig({\n  plugins: [],\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"构建入口",children:["构建入口",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#构建入口",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Rsbuild 与 Vite 默认的构建入口不同，Vite 使用 ",(0,s.jsx)(n.code,{children:"index.html"})," 作为默认入口，而 Rsbuild 使用 ",(0,s.jsx)(n.code,{children:"src/index.js"}),"。"]}),"\n",(0,s.jsxs)(n.p,{children:["从 Vite 迁移到 Rsbuild 时，你可以使用 Rsbuild 提供的 ",(0,s.jsx)(n.a,{href:"/config/source/entry",children:"source.entry"})," 来设置构建入口，",(0,s.jsx)(n.a,{href:"/config/html/template",children:"html.template"})," 来设置模板。"]}),"\n",(0,s.jsxs)(n.p,{children:["以一个新建的 Vite 项目为例，首先删除 ",(0,s.jsx)(n.code,{children:"index.html"})," 中的 ",(0,s.jsx)(n.code,{children:"<script>"})," 标签："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",meta:'title="index.html"',children:'- <script type="module" src="/src/main.ts"><\/script>\n'})}),"\n",(0,s.jsx)(n.p,{children:"然后添加如下配置即可。"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  html: {\n    template: './index.html',\n  },\n  source: {\n    entry: {\n      index: './src/main.ts',\n    },\n  },\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Rsbuild 会在构建时自动注入 ",(0,s.jsx)(n.code,{children:"<script>"})," 标签到生成的 HTML 文件中。"]}),"\n",(0,s.jsxs)(n.h2,{id:"迁移插件",children:["迁移插件",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#迁移插件",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"大部分常见的 Vite 插件可以轻松地迁移到 Rsbuild 插件，比如："}),"\n",(0,s.jsxs)(n.table,{children:["\n",(0,s.jsxs)(n.thead,{children:["\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.th,{children:"Vite"}),"\n",(0,s.jsx)(n.th,{children:"Rsbuild"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.tbody,{children:["\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-react",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-react"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-react",children:"@rsbuild/plugin-react"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-react-swc",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-react-swc"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-react",children:"@rsbuild/plugin-react"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-vue",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-vue"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-vue",children:"@rsbuild/plugin-vue"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-vue2",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-vue2"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-vue2",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-vue2"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-vue-jsx",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-vue-jsx"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-vue-jsx",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-vue-jsx"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-vue2-jsx",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-vue2-jsx"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-vue2-jsx",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-vue2-jsx"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-basic-ssl",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-basic-ssl"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-basic-ssl",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-basic-ssl"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@vitejs/plugin-legacy",target:"_blank",rel:"noopener noreferrer",children:"@vitejs/plugin-legacy"})}),"\n",(0,s.jsxs)(n.td,{children:["无须使用，详见 ",(0,s.jsx)(n.a,{href:"/guide/advanced/browser-compatibility",children:"浏览器兼容性"})]}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@sveltejs/vite-plugin-svelte",target:"_blank",rel:"noopener noreferrer",children:"@sveltejs/vite-plugin-svelte"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-svelte",children:"@rsbuild/plugin-svelte"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/vite-plugin-svgr",target:"_blank",rel:"noopener noreferrer",children:"vite-plugin-svgr"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-svgr",children:"@rsbuild/plugin-svgr"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/vite-plugin-checker",target:"_blank",rel:"noopener noreferrer",children:"vite-plugin-checker"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-type-check",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-type-check"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/vite-plugin-eslint",target:"_blank",rel:"noopener noreferrer",children:"vite-plugin-eslint"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-eslint",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-eslint"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/vite-plugin-static-copy",target:"_blank",rel:"noopener noreferrer",children:"vite-plugin-static-copy"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/copy",children:"output.copy"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/vite-plugin-node-polyfills",target:"_blank",rel:"noopener noreferrer",children:"vite-plugin-node-polyfills"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-node-polyfill",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-node-polyfill"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/vite-plugin-solid",target:"_blank",rel:"noopener noreferrer",children:"vite-plugin-solid"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-solid",children:"@rsbuild/plugin-solid"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/@preact/preset-vite",target:"_blank",rel:"noopener noreferrer",children:"@preact/preset-vite"})}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-preact",children:"@rsbuild/plugin-preact"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["你可以参考 ",(0,s.jsx)(n.a,{href:"/plugins/list/index",children:"插件列表"})," 来了解更多可用的插件。"]}),"\n",(0,s.jsxs)(n.h2,{id:"配置迁移",children:["配置迁移",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#配置迁移",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"以下是 Vite 配置对应的 Rsbuild 配置："}),"\n",(0,s.jsxs)(n.table,{children:["\n",(0,s.jsxs)(n.thead,{children:["\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.th,{children:"Vite"}),"\n",(0,s.jsx)(n.th,{children:"Rsbuild"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.tbody,{children:["\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"root"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/root",children:"root"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"mode"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/mode",children:"mode"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"base"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/base",children:"server.base"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"define"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/source/define",children:"source.define"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"appType"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/history-api-fallback",children:"server.historyApiFallback"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"plugins"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/plugins",children:"plugins"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"envDir"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/guide/advanced/env-vars#env-%E7%9B%AE%E5%BD%95",children:"Env Directory"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"publicDir"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/public-dir",children:"server.publicDir"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"assetsInclude"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/source/assets-include",children:"source.assetsInclude"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"resolve.alias"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/resolve/alias",children:"resolve.alias"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"resolve.dedupe"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/resolve/dedupe",children:"resolve.dedupe"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"resolve.extensions"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/resolve/extensions",children:"resolve.extensions"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"resolve.conditions"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/tools/rspack",children:"tools.rspack.resolve.conditionNames"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"resolve.mainFields"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/tools/rspack",children:"tools.rspack.resolve.mainFields"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"resolve.preserveSymlinks"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/tools/rspack",children:"tools.rspack.resolve.symlinks"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"html.cspNonce"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/security/nonce",children:"security.nonce"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"css.modules"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/css-modules",children:"output.cssModules"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"css.postcss"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/tools/postcss",children:"tools.postcss"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"css.preprocessorOptions.sass"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-sass",children:"pluginSass"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"css.preprocessorOptions.less"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-less",children:"pluginLess"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"css.preprocessorOptions.stylus"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/plugins/list/plugin-stylus",children:"pluginStylus"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"css.devSourcemap"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/source-map",children:"output.sourceMap"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"css.lightningcss"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/tools/lightningcss-loader",children:"tools.lightningcssLoader"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.host, preview.host"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/host",children:"server.host"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.port, preview.port"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/port",children:"server.port"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.cors, preview.cors"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/cors",children:"server.cors"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.strictPort, preview.strictPort"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/strict-port",children:"server.strictPort"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.https, preview.https"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/https",children:"server.https"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.open, preview.open"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/open",children:"server.open"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.proxy, preview.proxy"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/proxy",children:"server.proxy"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.headers, preview.headers"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/headers",children:"server.headers"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"server.hmr"}),"\n",(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.a,{href:"/config/dev/hmr",children:"dev.hmr"}),", ",(0,s.jsx)(n.a,{href:"/config/dev/client",children:"dev.client"})]}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.target, build.cssTarget"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/guide/advanced/browserslist",children:"Browserslist"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.outDir, build.assetsDir"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/dist-path",children:"output.distPath"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.assetsInlineLimit"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/data-uri-limit",children:"output.dataUriLimit"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.cssMinify"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/minify",children:"output.minify"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.sourcemap"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/source-map",children:"output.sourceMap"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.lib"}),"\n",(0,s.jsxs)(n.td,{children:["Use ",(0,s.jsx)(n.a,{href:"https://github.com/web-infra-dev/rslib",target:"_blank",rel:"noopener noreferrer",children:"Rslib"})]}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.manifest"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/manifest",children:"output.manifest"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.ssrEmitAssets"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/emit-assets",children:"output.emitAssets"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.minify, build.terserOptions"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/minify",children:"output.minify"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.emptyOutDir"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/output/clean-dist-path",children:"output.cleanDistPath"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.copyPublicDir"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/server/public-dir",children:"server.publicDir"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"build.reportCompressedSize"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/performance/print-file-size",children:"performance.printFileSize"})}),"\n"]}),"\n",(0,s.jsxs)(n.tr,{children:["\n",(0,s.jsx)(n.td,{children:"ssr, worker"}),"\n",(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/config/environments",children:"environments"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"说明："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"上述表格尚未覆盖到 Vite 的所有配置，欢迎补充。"}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"环境变量",children:["环境变量",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#环境变量",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Vite 默认会将 ",(0,s.jsx)(n.code,{children:"VITE_"})," 开头的环境变量注入到 client 代码中，而 Rsbuild 默认会注入 ",(0,s.jsx)(n.code,{children:"PUBLIC_"})," 开头的环境变量（参考 ",(0,s.jsx)(n.a,{href:"/guide/advanced/env-vars#public-%E5%8F%98%E9%87%8F",children:"public 变量"}),"）。"]}),"\n",(0,s.jsxs)(n.p,{children:["为了兼容 Vite 的行为，你可以手动调用 Rsbuild 提供的 ",(0,s.jsx)(n.a,{href:"/api/javascript-api/core#loadenv",children:"loadEnv"})," 方法来读取 ",(0,s.jsx)(n.code,{children:"VITE_"})," 开头的环境变量，并通过 ",(0,s.jsx)(n.a,{href:"/config/source/define",children:"source.define"})," 配置项注入到 client 代码中。"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { defineConfig, loadEnv } from '@rsbuild/core';\n\nconst { publicVars } = loadEnv({ prefixes: ['VITE_'] });\n\nexport default defineConfig({\n  source: {\n    define: publicVars,\n  },\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Rsbuild 默认注入了以下 ",(0,s.jsx)(n.a,{href:"/guide/advanced/env-vars",children:"环境变量"}),"："]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"import.meta.env.MODE"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"import.meta.env.BASE_URL"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"import.meta.env.PROD"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"import.meta.env.DEV"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["对于 ",(0,s.jsx)(n.code,{children:"import.meta.env.SSR"}),"，你可以通过 ",(0,s.jsx)(n.a,{href:"/config/environments",children:"environments"})," 和 ",(0,s.jsx)(n.a,{href:"/config/source/define",children:"source.define"})," 配置项来设置："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default defineConfig({\n  environments: {\n    web: {\n      source: {\n        define: {\n          'import.meta.env.SSR': JSON.stringify(false),\n        },\n      },\n    },\n    node: {\n      source: {\n        define: {\n          'import.meta.env.SSR': JSON.stringify(true),\n        },\n      },\n      output: {\n        target: 'node',\n      },\n    },\n  },\n});\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"预设类型",children:["预设类型",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#预设类型",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Vite 通过 ",(0,s.jsx)(n.code,{children:"vite-env.d.ts"})," 文件提供了一些预设的类型定义，迁移到 Rsbuild 时，你可以使用 ",(0,s.jsx)(n.code,{children:"@rsbuild/core"})," 提供的 ",(0,s.jsx)(n.a,{href:"/guide/basic/typescript#%E9%A2%84%E8%AE%BE%E7%B1%BB%E5%9E%8B",children:"预设类型"}),"："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",meta:'title="src/env.d.ts"',children:'- /// <reference types="vite/client" />\n+ /// <reference types="@rsbuild/core/types" />\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"glob-import",children:["Glob Import",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#glob-import",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Vite 提供了 ",(0,s.jsx)(n.code,{children:"import.meta.glob()"})," 来批量导入模块。"]}),"\n",(0,s.jsxs)(n.p,{children:["迁移到 Rsbuild 时，你可以使用 Rspack 的 ",(0,s.jsx)(n.a,{href:"https://rspack.dev/zh/api/runtime-api/module-variables#importmetawebpackcontext",target:"_blank",rel:"noopener noreferrer",children:"import.meta.webpackContext"})," 函数代替："]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Vite:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const modules = import.meta.glob('./dir/*.js');\n\nfor (const path in modules) {\n  modules[path]().then((mod) => {\n    console.log(path, mod);\n  });\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Rsbuild:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const context = import.meta.webpackContext('./dir', {\n  // 是否搜索子目录\n  recursive: false,\n  regExp: /\\.js$/,\n});\n\nfor (const path of context.keys()) {\n  const mod = context(path);\n  console.log(path, mod);\n}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"验证结果",children:["验证结果",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#验证结果",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["完成以上步骤后，你已经完成了从 Vite 到 Rsbuild 的基本迁移，此时可以执行 ",(0,s.jsx)(n.code,{children:"npm run dev"})," 命令来尝试启动开发服务器。"]}),"\n",(0,s.jsx)(n.p,{children:"如果在构建过程中发现问题，请根据错误日志进行调试，或者查看 Vite 配置，检查是否有一些必须的配置未被迁移到 Rsbuild。"}),"\n",(0,s.jsxs)(n.h2,{id:"内容补充",children:["内容补充",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#内容补充",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"当前文档只涵盖了迁移过程的部分事项，如果你发现有合适的内容可以补充，欢迎通过 pull request 来完善文档 \uD83E\uDD1D。"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Rsbuild 的文档位于 ",(0,s.jsx)(n.a,{href:"https://github.com/web-infra-dev/rsbuild/tree/main/website",target:"_blank",rel:"noopener noreferrer",children:"rsbuild/website"})," 目录。"]}),"\n"]})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}let c=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["zh%2Fguide%2Fmigration%2Fvite.mdx"]={toc:[{text:"安装依赖",id:"安装依赖",depth:2},{text:"更新 npm scripts",id:"更新-npm-scripts",depth:2},{text:"创建配置文件",id:"创建配置文件",depth:2},{text:"构建入口",id:"构建入口",depth:2},{text:"迁移插件",id:"迁移插件",depth:2},{text:"配置迁移",id:"配置迁移",depth:2},{text:"环境变量",id:"环境变量",depth:2},{text:"预设类型",id:"预设类型",depth:2},{text:"Glob Import",id:"glob-import",depth:2},{text:"验证结果",id:"验证结果",depth:2},{text:"内容补充",id:"内容补充",depth:2}],title:"Vite",frontmatter:{}}}}]);