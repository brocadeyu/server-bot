"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["1257"],{8930:function(e,n,s){s.r(n),s.d(n,{default:function(){return d}});var r=s(55367),t=s(26971);function l(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",pre:"pre",code:"code",div:"div",h3:"h3",ul:"ul",li:"li",blockquote:"blockquote"},(0,t.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"配置-html-模板",children:["配置 HTML 模板",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#配置-html-模板",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"在构建的过程中，Rsbuild 会基于 HTML 模板文件和模板参数进行编译，生成若干份 HTML 文件。"}),"\n",(0,r.jsx)(n.p,{children:"Rsbuild 提供了一些配置项来对 HTML 模板进行设置。通过本章节你可以了解到这些配置项的基本用法。"}),"\n",(0,r.jsxs)(n.h2,{id:"设置模板文件",children:["设置模板文件",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#设置模板文件",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["在 Rsbuild 中，你可以使用 ",(0,r.jsx)(n.a,{href:"/config/html/template",children:"html.template"})," 配置项来设置自定义的 HTML 模板文件。"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  html: {\n    template: './static/index.html',\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:["未设置 ",(0,r.jsx)(n.code,{children:"html.template"})," 时，Rsbuild 会使用内置的 HTML 模板："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",meta:'title="defaultTemplate.html"',children:'<!doctype html>\n<html>\n  <head></head>\n  <body>\n    <div id="<%= mountId %>"></div>\n  </body>\n</html>\n'})}),"\n",(0,r.jsxs)(n.h2,{id:"设置页面标题",children:["设置页面标题",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#设置页面标题",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["你可以通过 ",(0,r.jsx)(n.a,{href:"/config/html/title",children:"html.title"})," 配置项来设置 HTML 的 ",(0,r.jsx)(n.code,{children:"<title>"})," 标签。"]}),"\n",(0,r.jsxs)(n.p,{children:["当你的项目中只有一个页面时，直接使用 ",(0,r.jsx)(n.code,{children:"html.title"})," 设置即可："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  html: {\n    title: 'example',\n  },\n};\n"})}),"\n",(0,r.jsx)(n.p,{children:"当你的项目中有多个页面时，可以基于入口名称，来为不同的页面设置对应的标题。"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  html: {\n    title({ entryName }) {\n      const titles = {\n        foo: 'Foo',\n        bar: 'Bar',\n      };\n      return titles[entryName];\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(n.div,{className:"rspress-directive-content",children:(0,r.jsxs)(n.p,{children:["对于单页应用（SPA），Rsbuild 会在 HTML 页面中包含一个初始的 title，但你通常需要在路由切换时动态更新页面标题，例如使用一些路由库，或是 ",(0,r.jsx)(n.a,{href:"https://github.com/nfl/react-helmet",target:"_blank",rel:"noopener noreferrer",children:"React Helmet"})," 这类库。\n"]})})]}),"\n",(0,r.jsxs)(n.h2,{id:"设置页面图标",children:["设置页面图标",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#设置页面图标",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 支持设置 ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Glossary/Favicon",target:"_blank",rel:"noopener noreferrer",children:"favicon"})," 图标 和 iOS 系统下的 ",(0,r.jsx)(n.a,{href:"https://webhint.io/docs/user-guide/hints/hint-apple-touch-icons/",target:"_blank",rel:"noopener noreferrer",children:"apple-touch-icon"})," 图标。"]}),"\n",(0,r.jsxs)(n.p,{children:["你可以通过 ",(0,r.jsx)(n.a,{href:"/config/html/favicon",children:"html.favicon"})," 配置项来设置 favicon 图标。"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:["你也可以通过 ",(0,r.jsx)(n.a,{href:"/config/html/app-icon",children:"html.appIcon"})," 配置项来设置 Web 应用的图标，用于在添加到移动设备的主屏幕时显示。"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  html: {\n    appIcon: {\n      name: 'My Website',\n      icons: [\n        { src: './src/assets/logo-192.png', size: 192 },\n        { src: './src/assets/logo-512.png', size: 512 },\n      ],\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"设置-meta-标签",children:["设置 meta 标签",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#设置-meta-标签",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["你可以通过 ",(0,r.jsx)(n.a,{href:"/config/html/meta",children:"html.meta"})," 配置项来设置 HTML 的 ",(0,r.jsx)(n.code,{children:"<meta>"})," 标签。"]}),"\n",(0,r.jsx)(n.p,{children:"Rsbuild 默认设置了 charset 和 viewport meta 标签："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<meta charset="UTF-8" />\n<meta name="viewport" content="width=device-width, initial-scale=1.0" />\n'})}),"\n",(0,r.jsx)(n.p,{children:"你也可以添加自定义的 meta 标签，比如设置 description："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n"})}),"\n",(0,r.jsx)(n.p,{children:"最终在 HTML 中生成的 meta 标签为："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<meta name="description" content="a description of the page" />\n'})}),"\n",(0,r.jsxs)(n.h2,{id:"默认模板引擎",children:["默认模板引擎",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#默认模板引擎",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 内置了一个默认的模板引擎来处理 HTML 模板文件，它的语法接近 EJS 的子集，但也有一些不同。当 HTML 模板文件的后缀为 ",(0,r.jsx)(n.code,{children:".html"})," 时，Rsbuild 会使用内置的模板引擎来解析 HTML 模板。"]}),"\n",(0,r.jsxs)(n.p,{children:["例如，在模板中定义一个 ",(0,r.jsx)(n.code,{children:"text"})," 参数，值为 ",(0,r.jsx)(n.code,{children:"'world'"}),"。Rsbuild 在构建时会自动将 ",(0,r.jsx)(n.code,{children:"<%= text %>"})," 替换为指定的值。"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"\x3c!-- 输入  --\x3e\n<div>hello <%= text %>!</div>\n\n\x3c!-- 输出 --\x3e\n<div>hello world!</div>\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"模板参数",children:["模板参数",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模板参数",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"在 HTML 模板中，你可以使用丰富的模板参数，Rsbuild 默认注入的模板参数包括："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type DefaultParameters = {\n  mountId: string; // 对应 html.mountId 配置\n  entryName: string; // 入口名称\n  assetPrefix: string; // 对应 dev.assetPrefix 和 output.assetPrefix 配置\n  compilation: Compilation; // 对应 Rspack 的 compilation 对象\n  rspackConfig: Rspack.Configuration; // Rspack 的配置对象\n  // html-rspack-plugin 生成的参数\n  htmlPlugin: {\n    tags: {\n      headTags: HtmlTagObject[];\n      bodyTags: HtmlTagObject[];\n    };\n    files: {\n      publicPath: string;\n      js: Array<string>;\n      css: Array<string>;\n      favicon?: string;\n    };\n  };\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:["你可以通过 ",(0,r.jsx)(n.a,{href:"/config/html/template-parameters",children:"html.templateParameters"})," 配置项来传入自定义的模板参数，比如："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  html: {\n    templateParameters: {\n      text: 'world',\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:["接下来，你可以在 HTML 模板中，通过 ",(0,r.jsx)(n.code,{children:"<%= text %>"})," 来读取参数："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",meta:'title="index.html"',children:"<div>hello <%= text %>!</div>\n"})}),"\n",(0,r.jsx)(n.p,{children:"编译后的 HTML 代码如下："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",meta:'title="dist/index.html"',children:"<div>hello world!</div>\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"参数转义",children:["参数转义",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#参数转义",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["使用 ",(0,r.jsx)(n.code,{children:"<%= text %>"})," 时，参数不会被转义。你可以使用 ",(0,r.jsx)(n.code,{children:"<%- text %>"})," 来 escape 参数。"]}),"\n",(0,r.jsxs)(n.p,{children:["比如参数 ",(0,r.jsx)(n.code,{children:"text"})," 的值是 ",(0,r.jsx)(n.code,{children:"'<script>'"}),"，则会被转义为 ",(0,r.jsx)(n.code,{children:"&lt;script&gt;"}),"："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"\x3c!-- 输入  --\x3e\n<div>hello <%- text %>!</div>\n\n\x3c!-- 输出 --\x3e\n<div>hello &lt;script&gt;!</div>\n"})}),"\n",(0,r.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(n.div,{className:"rspress-directive-content",children:(0,r.jsxs)(n.p,{children:["注意，Rsbuild 默认的转义语法是与 EJS 不同的。在 EJS 中，默认的转义语法是 ",(0,r.jsx)(n.code,{children:"<%= text %>"}),"，而 Rsbuild 的默认转义语法是 ",(0,r.jsx)(n.code,{children:"<%- text %>"}),"。\n"]})})]}),"\n",(0,r.jsxs)(n.h2,{id:"其他模板引擎",children:["其他模板引擎",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#其他模板引擎",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 也支持通过插件来使用其他模板引擎，如 ",(0,r.jsx)(n.a,{href:"https://ejs.co/",target:"_blank",rel:"noopener noreferrer",children:"EJS"}),"、",(0,r.jsx)(n.a,{href:"https://pugjs.org/",target:"_blank",rel:"noopener noreferrer",children:"Pug"})," 等。"]}),"\n",(0,r.jsxs)(n.h3,{id:"ejs",children:["EJS",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#ejs",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 内置的模板语法与 ",(0,r.jsx)(n.a,{href:"https://ejs.co/",target:"_blank",rel:"noopener noreferrer",children:"EJS"})," 存在一些差异，如果你需要使用完整的 EJS 语法，可以通过插件来支持，详见 ",(0,r.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-ejs",target:"_blank",rel:"noopener noreferrer",children:"rsbuild-plugin-ejs"}),"。"]}),"\n",(0,r.jsxs)(n.h3,{id:"pug",children:["Pug",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#pug",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 通过插件来支持 ",(0,r.jsx)(n.a,{href:"https://pugjs.org/",target:"_blank",rel:"noopener noreferrer",children:"Pug"})," 模板引擎，详见 ",(0,r.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-pug",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-pug"}),"。"]}),"\n",(0,r.jsxs)(n.h2,{id:"注入标签",children:["注入标签",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#注入标签",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["通过配置 ",(0,r.jsx)(n.a,{href:"/config/html/tags",children:"html.tags"})," 选项，可以在 Rsbuild 生成的 HTML 文件中插入任意标签。"]}),"\n",(0,r.jsxs)(n.p,{children:["在 HTML 的模版中，可以通过 ",(0,r.jsx)(n.code,{children:"htmlPlugin.tags"})," 变量来访问被注入到 HTML 的所有标签："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",meta:'title="index.html"',children:'<html>\n  <head>\n    <%= htmlPlugin.tags.headTags %>\n  </head>\n  <body>\n    <div id="root"></div>\n    <%= htmlPlugin.tags.bodyTags %>\n  </body>\n</html>\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"html.tags"})," 的作用就是调整这些 tags 变量，从而修改 HTML 里的标签，下面是一个基本的例子："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  html: {\n    tags: [\n      { tag: 'script', attrs: { src: 'https://cdn.example.com/my-script.js' } },\n    ],\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"生成的 HTML 文件如下："}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<html>\n  <head>\n    <script src="https://cdn.example.com/my-script.js"><\/script>\n    \x3c!-- some other headTags... --\x3e\n  </head>\n  <body>\n    \x3c!-- some other bodyTags... --\x3e\n  </body>\n</html>\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["更多用法请参考：",(0,r.jsx)(n.a,{href:"/config/html/tags",children:"html.tags"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(n.div,{className:"rspress-directive-content",children:(0,r.jsxs)(n.p,{children:["通常你不需要手动使用 ",(0,r.jsx)(n.code,{children:"htmlPlugin.tags.headTags"})," 和 ",(0,r.jsx)(n.code,{children:"htmlPlugin.tags.bodyTags"})," 模板参数，因为 Rsbuild 会自动注入这些标签。参考 ",(0,r.jsx)(n.a,{href:"/config/html/inject",children:"html.inject"})," 了解调整标签注入位置。\n"]})})]}),"\n",(0,r.jsxs)(n.h2,{id:"html-插件",children:["HTML 插件",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#html-插件",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 内部基于 ",(0,r.jsx)(n.a,{href:"https://github.com/rspack-contrib/html-rspack-plugin",target:"_blank",rel:"noopener noreferrer",children:"html-rspack-plugin"})," 实现 HTML 相关的能力。它是 ",(0,r.jsx)(n.a,{href:"https://github.com/jantimon/html-webpack-plugin",target:"_blank",rel:"noopener noreferrer",children:"html-webpack-plugin"})," 的一个 fork 版本，具备完全一致的功能和选项。"]}),"\n",(0,r.jsxs)(n.p,{children:["你可以通过 ",(0,r.jsx)(n.a,{href:"/config/tools/html-plugin",children:"tools.htmlPlugin"})," 来修改 html-rspack-plugin 的选项，也可以禁用内置的 html-rspack-plugin 插件。"]}),"\n",(0,r.jsx)(n.p,{children:"比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    htmlPlugin(config, { entryName }) {\n      if (process.env.NODE_ENV === 'production') {\n        config.filename = `${entryName}.[contenthash:8].html`;\n      }\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"html-压缩",children:["HTML 压缩",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#html-压缩",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 目前不对 HTML 文件进行压缩，如果你需要压缩 HTML 文件，可以使用 ",(0,r.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-html-minifier-terser",target:"_blank",rel:"noopener noreferrer",children:"rsbuild-plugin-html-minifier-terser 插件"}),"。"]})]})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,t.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}let d=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["zh%2Fguide%2Fbasic%2Fhtml-template.mdx"]={toc:[{text:"设置模板文件",id:"设置模板文件",depth:2},{text:"设置页面标题",id:"设置页面标题",depth:2},{text:"设置页面图标",id:"设置页面图标",depth:2},{text:"设置 meta 标签",id:"设置-meta-标签",depth:2},{text:"默认模板引擎",id:"默认模板引擎",depth:2},{text:"模板参数",id:"模板参数",depth:3},{text:"参数转义",id:"参数转义",depth:3},{text:"其他模板引擎",id:"其他模板引擎",depth:2},{text:"EJS",id:"ejs",depth:3},{text:"Pug",id:"pug",depth:3},{text:"注入标签",id:"注入标签",depth:2},{text:"HTML 插件",id:"html-插件",depth:2},{text:"HTML 压缩",id:"html-压缩",depth:2}],title:"配置 HTML 模板",frontmatter:{}}}}]);