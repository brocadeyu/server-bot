"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["5880"],{53383:function(e,s,n){n.r(s),n.d(s,{default:function(){return d}});var r=n(55367),c=n(26971);function a(e){let s=Object.assign({h1:"h1",a:"a",ul:"ul",li:"li",strong:"strong",pre:"pre",code:"code",p:"p",div:"div",h2:"h2"},(0,c.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"outputsourcemap",children:["output.sourceMap",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#outputsourcemap",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"类型："})}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:"type SourceMap =\n  | boolean\n  | {\n      js?: Rspack.Configuration['devtool'];\n      css?: boolean;\n    };\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"默认值："})}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:"const defaultSourceMap = {\n  js: mode === 'development' ? 'cheap-module-source-map' : false,\n  css: false,\n};\n"})}),"\n",(0,r.jsx)(s.p,{children:"用于设置是否生成 source map 文件，以及生成哪一种格式的 source map。"}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"什么是 source map"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsx)(s.p,{children:"source map 是保存源代码映射关系的信息文件，它记录了编译后的代码的每一个位置，以及所对应的编译前的位置。通过 source map，可以在调试编译后的代码时，直接查看对应的源代码。"})})]}),"\n",(0,r.jsxs)(s.h2,{id:"默认行为",children:["默认行为",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#默认行为",children:"#"})]}),"\n",(0,r.jsx)(s.p,{children:"默认情况下，Rsbuild 的 source map 生成规则如下："}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"在开发模式构建时，会生成 JS 文件的 source map，便于进行开发调试；不会生成 CSS 文件的 source map。"}),"\n",(0,r.jsx)(s.li,{children:"在生产模式构建时，不会生成 JS 和 CSS 文件的 source map，以提供最佳的构建性能。"}),"\n"]}),"\n",(0,r.jsxs)(s.h2,{id:"布尔值",children:["布尔值",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#布尔值",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["如果 ",(0,r.jsx)(s.code,{children:"output.sourceMap"})," 为 ",(0,r.jsx)(s.code,{children:"true"}),"，则会根据 ",(0,r.jsx)(s.a,{href:"/config/mode",children:"mode"})," 生成 JS 和 CSS 文件的 source map，等价于："]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"export default {\n  output: {\n    sourceMap: {\n      js: mode === 'development' ? 'cheap-module-source-map' : 'source-map',\n      css: true,\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(s.p,{children:["如果 ",(0,r.jsx)(s.code,{children:"output.sourceMap"})," 为 ",(0,r.jsx)(s.code,{children:"false"}),"，则不会生成 JS 和 CSS 文件的 source map，等价于："]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"export default {\n  output: {\n    sourceMap: {\n      js: false,\n      css: false,\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(s.h2,{id:"js-source-map",children:["JS Source Map",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#js-source-map",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["JS 文件的 source map 通过 ",(0,r.jsx)(s.code,{children:"sourceMap.js"})," 来控制，可以传入 Rspack ",(0,r.jsx)(s.a,{href:"https://rspack.dev/zh/config/devtool",target:"_blank",rel:"noopener noreferrer",children:"devtool"})," 选项支持的所有 source map 格式，设置为 ",(0,r.jsx)(s.code,{children:"false"})," 为关闭。"]}),"\n",(0,r.jsx)(s.p,{children:"比如，如果你需要在所有模式生成高质量的 source map，可以设置为："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"export default {\n  output: {\n    sourceMap: {\n      js: 'source-map',\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(s.p,{children:["你也可以根据 ",(0,r.jsx)(s.code,{children:"NODE_ENV"})," 来设置不同的 source map 格式："]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"export default {\n  output: {\n    sourceMap: {\n      js:\n        process.env.NODE_ENV === 'production'\n          ? // 生产模式使用高质量的 source map 格式\n            'source-map'\n          : // 开发模式使用性能更好的 source map 格式\n            'cheap-module-source-map',\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(s.h2,{id:"css-source-map",children:["CSS Source Map",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#css-source-map",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["CSS 文件的 source map 通过 ",(0,r.jsx)(s.code,{children:"sourceMap.css"})," 来控制，设置为 ",(0,r.jsx)(s.code,{children:"true"})," 为开启，设置为 ",(0,r.jsx)(s.code,{children:"false"})," 为关闭。"]}),"\n",(0,r.jsx)(s.p,{children:"比如，如果需要生成 CSS 文件的 source map，可以设置为："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"export default {\n  output: {\n    sourceMap: {\n      css: true,\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(s.p,{children:["在生产构建时，我们不推荐同时开启 ",(0,r.jsx)(s.a,{href:"/config/output/inject-styles",children:"output.injectStyles"})," 和 ",(0,r.jsx)(s.code,{children:"output.sourceMap.css"}),"，因为 ",(0,r.jsx)(s.code,{children:"output.injectStyles"})," 会将 source map 注入到 JS 文件中，这会增加文件的体积并导致页面加载变慢。"]}),"\n",(0,r.jsx)(s.p,{children:"你可以仅在开发模式下开启 CSS 文件的 source map："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"export default {\n  output: {\n    injectStyles: true,\n    sourceMap: {\n      css: process.env.NODE_ENV === 'development',\n    },\n  },\n};\n"})})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.ah)(),e.components);return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}let d=o;o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["zh%2Fconfig%2Foutput%2Fsource-map.mdx"]={toc:[{text:"默认行为",id:"默认行为",depth:2},{text:"布尔值",id:"布尔值",depth:2},{text:"JS Source Map",id:"js-source-map",depth:2},{text:"CSS Source Map",id:"css-source-map",depth:2}],title:"output.sourceMap",frontmatter:{}}}}]);