"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["2404"],{29483:function(e,n,r){r.r(n),r.d(n,{default:function(){return h}});var i=r(55367),d=r(26971),s=r(38146);function l(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",strong:"strong",pre:"pre",code:"code",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",blockquote:"blockquote"},(0,d.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h1,{id:"modernjs-builder",children:["Modern.js Builder",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#modernjs-builder",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"本章节介绍如何将使用 Modern.js Builder (或 EdenX Builder) 的项目迁移到 Rsbuild。"}),"\n",(0,i.jsxs)(n.h2,{id:"主要区别",children:["主要区别",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#主要区别",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"Rsbuild 是 Modern.js Builder 的新版本，主要区别如下："}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Rsbuild 的性能更出色，在同时使用 Rspack 的情况下，",(0,i.jsx)(n.strong,{children:"Rsbuild 的启动速度和构建速度是 Builder 的 1.5 ~ 2 倍"}),"。"]}),"\n",(0,i.jsx)(n.li,{children:"Rsbuild 仅支持 Rspack 作为打包工具，不再支持 Webpack。"}),"\n",(0,i.jsx)(n.li,{children:"Rsbuild 的 CLI 工具和 dev server 更加强大，支持更多功能。"}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"安装依赖",children:["安装依赖",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安装依赖",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"首先你需要把 Builder 相关的 npm 依赖替换为 Rsbuild 的依赖。"}),"\n","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"移除 Builder 的依赖："}),"\n"]}),"\n",(0,i.jsx)(s.PackageManagerTabs,{command:"remove @modern-js/builder-cli @modern-js/builder-webpack-provider @modern-js/builder-rspack-provider"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"安装 Rsbuild 的依赖："}),"\n"]}),"\n",(0,i.jsx)(s.PackageManagerTabs,{command:"add @rsbuild/core -D"}),"\n",(0,i.jsxs)(n.h2,{id:"更新-npm-scripts",children:["更新 npm scripts",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#更新-npm-scripts",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"下一步，你需要把 package.json 中的 npm scripts 更新为 Rsbuild 的 CLI 命令。"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-diff",meta:'title="package.json"',children:'{\n  "scripts": {\n-   "dev": "builder dev",\n-   "build": "builder build",\n-   "serve": "builder serve"\n+   "dev": "rsbuild dev",\n+   "build": "rsbuild build",\n+   "preview": "rsbuild preview"\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"修改配置文件",children:["修改配置文件",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#修改配置文件",children:"#"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["将 ",(0,i.jsx)(n.code,{children:"builder.config.ts"})," 重命名为 ",(0,i.jsx)(n.code,{children:"rsbuild.config.ts"}),"。"]}),"\n",(0,i.jsxs)(n.li,{children:["从 ",(0,i.jsx)(n.code,{children:"@modern-js/builder-cli"})," 中导入 ",(0,i.jsx)(n.code,{children:"defineConfig"})," 方法，改为从 ",(0,i.jsx)(n.code,{children:"@rsbuild/core"})," 中导入。"]}),"\n",(0,i.jsxs)(n.li,{children:["将 ",(0,i.jsx)(n.code,{children:"builderPlugins"})," 字段改为 ",(0,i.jsx)(n.code,{children:"plugins"}),"。"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-diff",meta:'title="rsbuild.config.ts"',children:"- import { defineConfig } from '@modern-js/builder-cli';\n+ import { defineConfig } from '@rsbuild/core';\n\nexport default defineConfig({\n-  builderPlugins: [],\n+  plugins: [],\n});\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"替换插件",children:["替换插件",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#替换插件",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"Rsbuild 和 Builder 的插件系统不兼容，因此需要将 Builder 的插件替换为 Rsbuild 的插件。"}),"\n",(0,i.jsx)(n.p,{children:"下面是 Builder 插件和 Rsbuild 插件的对应关系："}),"\n",(0,i.jsxs)(n.table,{children:["\n",(0,i.jsxs)(n.thead,{children:["\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.th,{children:"Builder"}),"\n",(0,i.jsx)(n.th,{children:"Rsbuild"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.tbody,{children:["\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.td,{children:"@modern-js/builder-plugin-vue"}),"\n",(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"/plugins/list/plugin-vue",children:"@rsbuild/plugin-vue"})}),"\n"]}),"\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.td,{children:"@modern-js/builder-plugin-vue2"}),"\n",(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-vue2",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-vue2"})}),"\n"]}),"\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.td,{children:"@modern-js/builder-plugin-stylus"}),"\n",(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"/plugins/list/plugin-stylus",children:"@rsbuild/plugin-stylus"})}),"\n"]}),"\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.td,{children:"@modern-js/builder-plugin-node-polyfill"}),"\n",(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-node-polyfill",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-node-polyfill"})}),"\n"]}),"\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.td,{children:"@modern-js/builder-plugin-image-compress"}),"\n",(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-image-compress",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-image-compress"})}),"\n"]}),"\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.td,{children:"@modern-js/builder-plugin-swc"}),"\n",(0,i.jsx)(n.td,{children:"默认生效，无须使用"}),"\n"]}),"\n",(0,i.jsxs)(n.tr,{children:["\n",(0,i.jsx)(n.td,{children:"@modern-js/builder-plugin-esbuild"}),"\n",(0,i.jsx)(n.td,{children:"不再支持"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["以 ",(0,i.jsx)(n.code,{children:"@modern-js/builder-plugin-vue"})," 为例，你需要先安装 ",(0,i.jsx)(n.code,{children:"@rsbuild/plugin-vue"}),"，然后在 ",(0,i.jsx)(n.code,{children:"rsbuild.config.ts"})," 中引入插件，并添加到 ",(0,i.jsx)(n.code,{children:"plugins"})," 字段中。"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-diff",meta:'title="rsbuild.config.ts"',children:"- import { builderPluginVue } from '@modern-js/builder-plugin-vue';\n+ import { pluginVue } from '@rsbuild/plugin-vue';\n\nexport default defineConfig({\n-  builderPlugins: [builderPluginVue()],\n+  plugins: [pluginVue()],\n});\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"添加-react-相关插件",children:["添加 React 相关插件",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#添加-react-相关插件",children:"#"})]}),"\n",(0,i.jsxs)(n.p,{children:["Rsbuild 不与任何前端 UI 框架耦合。因此，如果你是一个 React 项目，需要手动添加 ",(0,i.jsx)(n.a,{href:"/plugins/list/plugin-react",children:"React 插件"}),"："]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { pluginReact } from '@rsbuild/plugin-react';\n\nexport default {\n  plugins: [pluginReact()],\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["如果你当前项目中有使用 SVGR，还需要注册 Rsbuild 的 ",(0,i.jsx)(n.a,{href:"/plugins/list/plugin-svgr",children:"SVGR 插件"}),"："]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { pluginSvgr } from '@rsbuild/plugin-svgr';\n\nexport default {\n  plugins: [pluginSvgr()],\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["如果你是其他框架的使用者，可参考 ",(0,i.jsx)(n.a,{href:"/plugins/list/index",children:"插件列表"})," 选择对应的框架插件。"]}),"\n",(0,i.jsxs)(n.h2,{id:"配置迁移",children:["配置迁移",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#配置迁移",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"Rsbuild 和 Builder 的绝大多数配置项是一致的，仅有少许配置项进行了调整。"}),"\n",(0,i.jsxs)(n.p,{children:["你可以通过 ",(0,i.jsx)(n.a,{href:"/config/index",children:"Rsbuild 配置项"})," 来查看 Rsbuild 的配置项。"]}),"\n",(0,i.jsxs)(n.p,{children:["值得注意的是，相比 Builder，",(0,i.jsx)(n.strong,{children:"Rsbuild 中一些默认值和行为存在差异"}),"："]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["浏览器范围：默认最低兼容到支持 ",(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules",target:"_blank",rel:"noopener noreferrer",children:"原生 ES Modules"})," 的浏览器，可参考 ",(0,i.jsx)(n.a,{href:"/guide/advanced/browserslist#browserslist-%E9%BB%98%E8%AE%A4%E5%80%BC",children:"Browserslist 默认值"}),"。"]}),"\n",(0,i.jsxs)(n.li,{children:["HTML 文件输出位置：默认输出到 dist 目录的根部，可参考 ",(0,i.jsx)(n.a,{href:"/guide/basic/output-files#%E9%BB%98%E8%AE%A4%E4%BA%A7%E7%89%A9%E7%9B%AE%E5%BD%95",children:"默认产物目录"}),"。"]}),"\n",(0,i.jsxs)(n.li,{children:["Polyfill 注入方式：默认按需注入，可参考 ",(0,i.jsx)(n.a,{href:"/config/output/polyfill",children:"output.polyfill"}),"。"]}),"\n",(0,i.jsxs)(n.li,{children:["TypeScript 类型检查：默认不开启，需要手动注册 ",(0,i.jsx)(n.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-type-check",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-type-check"}),"。"]}),"\n",(0,i.jsxs)(n.li,{children:["修改 DevServer 配置：通过 ",(0,i.jsx)(n.code,{children:"dev"})," 和 ",(0,i.jsx)(n.code,{children:"server"})," 配置项修改。"]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"验证结果",children:["验证结果",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#验证结果",children:"#"})]}),"\n",(0,i.jsxs)(n.p,{children:["完成以上步骤后，你已经完成了从 Modern.js Builder 到 Rsbuild 的基本迁移，此时可以执行 ",(0,i.jsx)(n.code,{children:"npm run dev"})," 命令来尝试启动开发服务器。"]}),"\n",(0,i.jsx)(n.p,{children:"如果在构建过程中发现问题，请根据错误日志进行调试。"}),"\n",(0,i.jsxs)(n.h2,{id:"内容补充",children:["内容补充",(0,i.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#内容补充",children:"#"})]}),"\n",(0,i.jsx)(n.p,{children:"当前文档只涵盖了迁移过程的部分事项，如果你发现有合适的内容可以补充，欢迎通过 pull request 来完善文档 \uD83E\uDD1D。"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Rsbuild 的文档位于 ",(0,i.jsx)(n.a,{href:"https://github.com/web-infra-dev/rsbuild/tree/main/website",target:"_blank",rel:"noopener noreferrer",children:"rsbuild/website"})," 目录。"]}),"\n"]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,d.ah)(),e.components);return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}let h=c;c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["zh%2Fguide%2Fmigration%2Fmodern-builder.mdx"]={toc:[{text:"主要区别",id:"主要区别",depth:2},{text:"安装依赖",id:"安装依赖",depth:2},{text:"更新 npm scripts",id:"更新-npm-scripts",depth:2},{text:"修改配置文件",id:"修改配置文件",depth:2},{text:"替换插件",id:"替换插件",depth:2},{text:"添加 React 相关插件",id:"添加-react-相关插件",depth:2},{text:"配置迁移",id:"配置迁移",depth:2},{text:"验证结果",id:"验证结果",depth:2},{text:"内容补充",id:"内容补充",depth:2}],title:"Modern.js Builder",frontmatter:{}}}}]);