"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["4962"],{29115:function(e,s,n){n.r(s),n.d(s,{default:function(){return a}});var r=n(55367),l=n(26971),d=n(28855),i=n(38146);function c(e){let s=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",h3:"h3",div:"div",ul:"ul",li:"li",code:"code",pre:"pre",strong:"strong"},(0,l.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"less-插件",children:["Less 插件",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#less-插件",children:"#"})]}),"\n","\n",(0,r.jsx)(d.ZB,{href:"https://github.com/web-infra-dev/rsbuild/tree/main/packages/plugin-less"}),"\n",(0,r.jsxs)(s.p,{children:["使用 ",(0,r.jsx)(s.a,{href:"https://lesscss.org/",target:"_blank",rel:"noopener noreferrer",children:"Less"})," 作为 CSS 预处理器，基于 ",(0,r.jsx)(s.a,{href:"https://github.com/webpack-contrib/less-loader",target:"_blank",rel:"noopener noreferrer",children:"less-loader"})," 实现。"]}),"\n",(0,r.jsxs)(s.h2,{id:"快速开始",children:["快速开始",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#快速开始",children:"#"})]}),"\n",(0,r.jsxs)(s.h3,{id:"安装插件",children:["安装插件",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#安装插件",children:"#"})]}),"\n",(0,r.jsx)(s.p,{children:"你可以通过如下的命令安装插件:"}),"\n","\n",(0,r.jsx)(i.PackageManagerTabs,{command:"add @rsbuild/plugin-less -D"}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsxs)(s.div,{className:"rspress-directive-content",children:["\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Less 插件仅支持 @rsbuild/core >= 0.7.0 版本。"}),"\n",(0,r.jsx)(s.li,{children:"当 @rsbuild/core 版本小于 0.7.0 时，内置支持 Less 插件，你不需要安装该插件。"}),"\n"]}),"\n"]})]}),"\n",(0,r.jsxs)(s.h3,{id:"注册插件",children:["注册插件",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#注册插件",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["你可以在 ",(0,r.jsx)(s.code,{children:"rsbuild.config.ts"})," 文件中注册插件："]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { pluginLess } from '@rsbuild/plugin-less';\n\nexport default {\n  plugins: [pluginLess()],\n};\n"})}),"\n",(0,r.jsxs)(s.p,{children:["注册插件后，你可以在代码中引入 ",(0,r.jsx)(s.code,{children:"*.less"})," 或 ",(0,r.jsx)(s.code,{children:"*.module.less"})," 文件，无须添加其他配置。"]}),"\n",(0,r.jsxs)(s.h2,{id:"选项",children:["选项",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#选项",children:"#"})]}),"\n",(0,r.jsx)(s.p,{children:"如果你需要自定义 Less 的编译行为，可以使用以下配置项。"}),"\n",(0,r.jsxs)(s.h3,{id:"lessloaderoptions",children:["lessLoaderOptions",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#lessloaderoptions",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["修改 ",(0,r.jsx)(s.a,{href:"https://github.com/webpack-contrib/less-loader",target:"_blank",rel:"noopener noreferrer",children:"less-loader"})," 的配置。"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："})," ",(0,r.jsx)(s.code,{children:"Object | Function"})]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"默认值："})}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"const defaultOptions = {\n  lessOptions: {\n    javascriptEnabled: true,\n    paths: [path.join(rootPath, 'node_modules')],\n  },\n  implementation: require.resolve('less'),\n  sourceMap: rsbuildConfig.output.sourceMap.css,\n};\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"示例："})}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["当 ",(0,r.jsx)(s.code,{children:"lessLoaderOptions"})," 的值是一个对象时，它会与默认配置通过 ",(0,r.jsx)(s.code,{children:"Object.assign"})," 进行浅层合并，值得注意的是，",(0,r.jsx)(s.code,{children:"lessOptions"})," 会通过 deepMerge 进行深层合并。"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"pluginLess({\n  lessLoaderOptions: {\n    lessOptions: {\n      javascriptEnabled: false,\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(s.p,{children:["当 ",(0,r.jsx)(s.code,{children:"lessLoaderOptions"})," 的值是一个函数时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个值作为最终结果："]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"pluginLess({\n  lessLoaderOptions(config) {\n    config.lessOptions = {\n      javascriptEnabled: false,\n    };\n  },\n});\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"lessLoaderOptions.lessOptions"})," 是直接传递给 Less 的配置，请参阅 ",(0,r.jsx)(s.a,{href:"https://lesscss.org/usage/#command-line-usage-options",target:"_blank",rel:"noopener noreferrer",children:"Less 文档"})," 以了解所有可用选项。\n"]})})]}),"\n",(0,r.jsxs)(s.h3,{id:"include",children:["include",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#include",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："})," ",(0,r.jsx)(s.a,{href:"https://rspack.dev/config/module#condition",target:"_blank",rel:"noopener noreferrer",children:"RuleSetCondition"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"/\\.less$/"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"版本："})," ",(0,r.jsx)(s.code,{children:">= 1.1.0"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["用于指定一部分 ",(0,r.jsx)(s.code,{children:".less"})," 模块，这些模块会被 ",(0,r.jsx)(s.code,{children:"less-loader"})," 编译。这个值与 Rspack 中的 ",(0,r.jsx)(s.code,{children:"rule.test"})," 选项相同。"]}),"\n",(0,r.jsx)(s.p,{children:"比如："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:"pluginLess({\n  include: /\\.custom\\.less$/,\n});\n"})}),"\n",(0,r.jsxs)(s.h3,{id:"exclude",children:["exclude",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#exclude",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："})," ",(0,r.jsx)(s.a,{href:"https://rspack.dev/config/module#condition",target:"_blank",rel:"noopener noreferrer",children:"RuleSetCondition"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"undefined"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["用于排除一部分 ",(0,r.jsx)(s.code,{children:".less"})," 模块，这些模块不会被 ",(0,r.jsx)(s.code,{children:"less-loader"})," 编译。"]}),"\n",(0,r.jsx)(s.p,{children:"比如："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:"pluginLess({\n  exclude: /some-folder[\\\\/]foo\\.less/,\n});\n"})}),"\n",(0,r.jsxs)(s.h2,{id:"修改-less-版本",children:["修改 Less 版本",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#修改-less-版本",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["在某些场景下，如果你需要使用特定的 Less 版本，而不是使用 Rsbuild 内置的 Less v4，可以在项目中安装需要使用的 Less 版本，并通过 ",(0,r.jsx)(s.code,{children:"less-loader"})," 的 ",(0,r.jsx)(s.code,{children:"implementation"})," 选项设置。"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"pluginLess({\n  lessLoaderOptions: {\n    implementation: require('less'),\n  },\n});\n"})}),"\n",(0,r.jsxs)(s.h2,{id:"实践",children:["实践",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#实践",children:"#"})]}),"\n",(0,r.jsxs)(s.h3,{id:"配置多个-less-插件",children:["配置多个 Less 插件",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#配置多个-less-插件",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["通过使用 ",(0,r.jsx)(s.code,{children:"include"})," 和 ",(0,r.jsx)(s.code,{children:"exclude"})," 选项，你可以同时注册多个 Less 插件，并为每个插件指定不同的选项。"]}),"\n",(0,r.jsx)(s.p,{children:"例如："}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:"export default {\n  plugins: [\n    pluginLess({\n      exclude: /\\.another\\.less$/,\n    }),\n    pluginLess({\n      include: /\\.another\\.less$/,\n      lessLoaderOptions: {\n        // some custom options\n      },\n    }),\n  ],\n};\n"})}),"\n",(0,r.jsxs)(s.h2,{id:"常见问题",children:["常见问题",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#常见问题",children:"#"})]}),"\n",(0,r.jsxs)(s.h3,{id:"less-文件中的除法不生效",children:["Less 文件中的除法不生效？",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#less-文件中的除法不生效",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"@rsbuild/plugin-less"})," 内置的 Less 版本为 v4，与 v3 版本相比，除法的写法有一些区别："]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-less",children:"// Less v3\n.math {\n  width: 2px / 2; // 1px\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n// Less v4\n.math {\n  width: 2px / 2; // 2px / 2\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Less 中除法的写法可以通过配置项来修改，详见 ",(0,r.jsx)(s.a,{href:"https://lesscss.org/usage/#less-options-math",target:"_blank",rel:"noopener noreferrer",children:"Less - Math"}),"。"]})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,l.ah)(),e.components);return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}let a=h;h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["zh%2Fplugins%2Flist%2Fplugin-less.mdx"]={toc:[{text:"快速开始",id:"快速开始",depth:2},{text:"安装插件",id:"安装插件",depth:3},{text:"注册插件",id:"注册插件",depth:3},{text:"选项",id:"选项",depth:2},{text:"lessLoaderOptions",id:"lessloaderoptions",depth:3},{text:"include",id:"include",depth:3},{text:"exclude",id:"exclude",depth:3},{text:"修改 Less 版本",id:"修改-less-版本",depth:2},{text:"实践",id:"实践",depth:2},{text:"配置多个 Less 插件",id:"配置多个-less-插件",depth:3},{text:"常见问题",id:"常见问题",depth:2},{text:"Less 文件中的除法不生效？",id:"less-文件中的除法不生效",depth:3}],title:"Less 插件",frontmatter:{}}}}]);