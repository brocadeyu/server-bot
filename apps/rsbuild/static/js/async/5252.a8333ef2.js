"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["5252"],{1607:function(e,t,n){n.r(t),n.d(t,{default:function(){return i}});var s=n(55367),o=n(26971);function r(e){let t=Object.assign({h1:"h1",a:"a",h3:"h3",p:"p",div:"div",ol:"ol",li:"li",code:"code",h4:"h4",ul:"ul",hr:"hr",pre:"pre",blockquote:"blockquote"},(0,o.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.h1,{id:"hmr-faq",children:["HMR FAQ",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#hmr-faq",children:"#"})]}),"\n",(0,s.jsxs)(t.h3,{id:"how-to-troubleshooting-hmr-ineffective-issues",children:["How to troubleshooting HMR ineffective issues?",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#how-to-troubleshooting-hmr-ineffective-issues",children:"#"})]}),"\n",(0,s.jsx)(t.p,{children:"There are several possible reasons why HMR may not be work. This document will cover most common causes and provide guidance for troubleshooting. Please refer to the following content for troubleshooting."}),"\n",(0,s.jsx)(t.p,{children:"Before starting the troubleshooting process, it is helpful to have a basic understanding of how HMR works:"}),"\n",(0,s.jsxs)(t.div,{className:"rspress-directive tip",children:[(0,s.jsx)(t.div,{className:"rspress-directive-title",children:"HMR Principle"}),(0,s.jsxs)(t.div,{className:"rspress-directive-content",children:["\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"The browser establishes a WebSocket connection with the dev server for real-time communication."}),"\n",(0,s.jsxs)(t.li,{children:["Whenever the dev server finishes recompiling, it sends a notification to the browser via the WebSocket. The browser then sends a ",(0,s.jsx)(t.code,{children:"hot-update.(js|json)"})," request to the dev server to load the newly compiled module."]}),"\n",(0,s.jsx)(t.li,{children:"After receiving the new module, if it is a React project, React Refresh, an official React tool, is used to update React components. Other frameworks have similar tools."}),"\n"]}),"\n"]})]}),"\n",(0,s.jsx)(t.p,{children:"After understanding the principle of HMR, you can follow these steps for basic troubleshooting:"}),"\n",(0,s.jsxs)(t.h4,{id:"1-check-the-websocket-connection",children:["1. Check the WebSocket Connection",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#1-check-the-websocket-connection",children:"#"})]}),"\n",(0,s.jsxs)(t.p,{children:["Open the browser console and check for the presence of the ",(0,s.jsx)(t.code,{children:"[HMR] connected."})," log."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"If it is present, the WebSocket connection is working correctly. You can continue with the following steps."}),"\n",(0,s.jsxs)(t.li,{children:["If it is not present, open the Network panel in Chrome and check the status of the ",(0,s.jsx)(t.code,{children:"ws://[host]:[port]/rsbuild-hmr"})," request. If the request is failed, this indicates that the HMR failed because the WebSocket connection was not successfully established."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["There can be various reasons why the WebSocket connection fails to establish, such as using a network proxy that prevents the WebSocket request from reaching the dev server. You can check whether the WebSocket request address matches your dev server address. If it does not match, you can configure the WebSocket request address using ",(0,s.jsx)(t.a,{href:"/config/dev/client",children:"dev.client"}),"."]}),"\n",(0,s.jsxs)(t.h4,{id:"2-check-the-hot-update-requests",children:["2. Check the hot-update Requests",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#2-check-the-hot-update-requests",children:"#"})]}),"\n",(0,s.jsxs)(t.p,{children:["When you modify the code of a module and trigger a recompilation, the browser sends several ",(0,s.jsx)(t.code,{children:"hot-update.json"})," and ",(0,s.jsx)(t.code,{children:"hot-update.js"})," requests to the dev server to fetch the updated code."]}),"\n",(0,s.jsxs)(t.p,{children:["You can try modifying a module and inspect the content of the ",(0,s.jsx)(t.code,{children:"hot-update.(js|json)"})," requests. If the content of the request is the latest code, it indicates that the hot update request is working correctly."]}),"\n",(0,s.jsxs)(t.p,{children:["If the content of the request is incorrect, it is likely due to a network proxy. Check whether the address of the ",(0,s.jsx)(t.code,{children:"hot-update.(js|json)"})," request matches your dev server address. If it does not match, you need to adjust the proxy rules to route the ",(0,s.jsx)(t.code,{children:"hot-update.(js|json)"})," request to the dev server address."]}),"\n",(0,s.jsxs)(t.h4,{id:"3-check-for-other-causes",children:["3. Check for Other Causes",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#3-check-for-other-causes",children:"#"})]}),"\n",(0,s.jsx)(t.p,{children:"If the above two steps do not reveal any issues, it is possible that other factors are causing the HMR to fail. For example, it could be that the code does not meet React's requirements for HMR. You can refer to the following questions for further troubleshooting."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsxs)(t.h3,{id:"hmr-not-working-when-external-react",children:["HMR not working when external React?",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#hmr-not-working-when-external-react",children:"#"})]}),"\n",(0,s.jsx)(t.p,{children:"To ensure that HMR works properly, we need to use the development builds of React and ReactDOM."}),"\n",(0,s.jsxs)(t.p,{children:["If you exclude React via ",(0,s.jsx)(t.code,{children:"externals"})," when bundling, the production build of React is usually injected through CDN, and this can cause HMR to fail."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"export default {\n  output: {\n    externals: {\n      react: 'React',\n      'react-dom': 'ReactDOM',\n    },\n  },\n};\n"})}),"\n",(0,s.jsx)(t.p,{children:"To solve this problem, you need to reference the React development artifacts and install React DevTools, then hot reloading will work properly."}),"\n",(0,s.jsxs)(t.p,{children:["If you are unsure about the type of React build you are using, you can refer to the ",(0,s.jsx)(t.a,{href:"https://legacy.reactjs.org/docs/optimizing-performance.html#use-the-production-build",target:"_blank",rel:"noopener noreferrer",children:"React documentation - Use the Production Build"}),"."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsxs)(t.h3,{id:"hmr-not-working-when-setting-filename-hash-in-development-mode",children:["HMR not working when setting filename hash in development mode?",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#hmr-not-working-when-setting-filename-hash-in-development-mode",children:"#"})]}),"\n",(0,s.jsxs)(t.p,{children:["Usually, we only set the filename hash in the production mode (i.e., when ",(0,s.jsx)(t.code,{children:"process.env.NODE_ENV === 'production'"}),")."]}),"\n",(0,s.jsxs)(t.p,{children:["If you set the filename hash in the development mode, it may cause HMR to fail (especially for CSS files). This is because every time the file content changes, the hash value changes, preventing tools like ",(0,s.jsx)(t.a,{href:"https://npmjs.com/package/mini-css-extract-plugin",target:"_blank",rel:"noopener noreferrer",children:"mini-css-extract-plugin"})," from reading the latest file content."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Correct usage:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"export default {\n  output: {\n    filename: {\n      css:\n        process.env.NODE_ENV === 'production'\n          ? '[name].[contenthash:8].css'\n          : '[name].css',\n    },\n  },\n};\n"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Incorrect usage:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"export default {\n  output: {\n    filename: {\n      css: '[name].[contenthash:8].css',\n    },\n  },\n};\n"})}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsxs)(t.h3,{id:"hmr-not-working-when-use-https",children:["HMR not working when use https?",(0,s.jsx)(t.a,{className:"header-anchor","aria-hidden":"true",href:"#hmr-not-working-when-use-https",children:"#"})]}),"\n",(0,s.jsx)(t.p,{children:"If https is enabled, the HMR connection may fail due to a certificate issue, and if you open the console, you will get an HMR connect failed error."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-text",children:"\xbb WebSocket connection to 'wss://localhost:3000/rsbuild-hmr' failed:\n[HMR] disconnected. Attempting to reconnect.\n"})}),"\n",(0,s.jsx)(t.p,{children:'The solution to this problem is to click on "Advanced" -> "Proceed to some page (unsafe)" on the Chrome problem page.'}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:'Tips: When accessing the page through Localhost, the words "Your connection is not private" may not appear and can be handled by visiting the Network domain.'}),"\n"]})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:t}=Object.assign({},(0,o.ah)(),e.components);return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(r,{...e})}):r(e)}let i=h;h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["en%2Fguide%2Ffaq%2Fhmr.mdx"]={toc:[{text:"How to troubleshooting HMR ineffective issues?",id:"how-to-troubleshooting-hmr-ineffective-issues",depth:3},{text:"1. Check the WebSocket Connection",id:"1-check-the-websocket-connection",depth:4},{text:"2. Check the hot-update Requests",id:"2-check-the-hot-update-requests",depth:4},{text:"3. Check for Other Causes",id:"3-check-for-other-causes",depth:4},{text:"HMR not working when external React?",id:"hmr-not-working-when-external-react",depth:3},{text:"HMR not working when setting filename hash in development mode?",id:"hmr-not-working-when-setting-filename-hash-in-development-mode",depth:3},{text:"HMR not working when use https?",id:"hmr-not-working-when-use-https",depth:3}],title:"HMR FAQ",frontmatter:{}}}}]);