"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["7418"],{11718:function(e,n,r){r.r(n),r.d(n,{default:function(){return h}});var d=r(55367),s=r(26971);function l(e){let n=Object.assign({h1:"h1",a:"a",p:"p",ul:"ul",li:"li",h2:"h2",code:"code",pre:"pre"},(0,s.ah)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.h1,{id:"模块热更新",children:["模块热更新",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模块热更新",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"模块热更新（HMR - hot module replacement）功能会在应用程序运行过程中，替换、添加或删除模块，而无需重新加载整个页面。主要是通过以下几种方式，来显著加快开发速度："}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"保留在完全重新加载页面期间丢失的应用程序状态。"}),"\n",(0,d.jsx)(n.li,{children:"只更新变更内容，以节省宝贵的开发时间。"}),"\n",(0,d.jsx)(n.li,{children:"在源代码中 CSS / JS 产生修改时，会立刻在浏览器中进行更新，这几乎相当于在浏览器 devtools 直接更改样式。"}),"\n"]}),"\n",(0,d.jsxs)(n.h2,{id:"hmr-开关",children:["HMR 开关",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#hmr-开关",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"Rsbuild 已内置了对 HMR 的支持，在开发模式下默认启用。"}),"\n",(0,d.jsxs)(n.p,{children:["如果你不需要使用 HMR 能力，可以将 ",(0,d.jsx)(n.a,{href:"/config/dev/hmr",children:"dev.hmr"})," 设置为 ",(0,d.jsx)(n.code,{children:"false"}),"，此时热更新和 react-refresh 将被禁用，Rsbuild 会自动降级到 ",(0,d.jsx)(n.a,{href:"/config/dev/live-reload",children:"dev.liveReload"}),"。"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  dev: {\n    hmr: false,\n  },\n};\n"})}),"\n",(0,d.jsxs)(n.p,{children:["如果你需要同时禁用 HMR 和 liveReload，可以将 ",(0,d.jsx)(n.a,{href:"/config/dev/hmr",children:"dev.hmr"})," 和 ",(0,d.jsx)(n.a,{href:"/config/dev/live-reload",children:"dev.liveReload"})," 都设置为 ",(0,d.jsx)(n.code,{children:"false"}),"，此时页面上不会发起 Web Socket 请求到 dev server，也不会在文件变更时自动刷新页面。"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.ts"',children:"export default {\n  dev: {\n    hmr: false,\n    liveReload: false,\n  },\n};\n"})}),"\n",(0,d.jsxs)(n.h2,{id:"自定义-hmr-url",children:["自定义 HMR URL",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#自定义-hmr-url",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"在默认情况下，Rsbuild 使用当前页面的 host 和端口号来拼接 HMR 对应的 WebSocket URL。"}),"\n",(0,d.jsxs)(n.p,{children:["当出现 HMR 连接失败的情况时，你可以自定义 ",(0,d.jsx)(n.a,{href:"/config/dev/client",children:"dev.client"})," 配置来指定 WebSocket URL。"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  dev: {\n    client: {\n      host: 'localhost',\n      protocol: 'ws',\n    },\n  },\n};\n"})}),"\n",(0,d.jsxs)(n.h2,{id:"文件监听",children:["文件监听",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#文件监听",children:"#"})]}),"\n",(0,d.jsxs)(n.p,{children:["Rsbuild 默认不监听 ",(0,d.jsx)(n.code,{children:".git/"})," 和 ",(0,d.jsx)(n.code,{children:"node_modules/"})," 目录下的文件，当这些目录下的文件发生变化时，Rsbuild 不会触发重新构建。这有助于减少内存占用和提升构建性能。"]}),"\n",(0,d.jsxs)(n.p,{children:["如果你希望监听这些目录，可以手动配置 Rspack 的 ",(0,d.jsx)(n.a,{href:"https://rspack.dev/config/watch#watchoptionsignored",target:"_blank",rel:"noopener noreferrer",children:"watchOptions.ignored"})," 来覆盖默认行为。"]}),"\n",(0,d.jsxs)(n.p,{children:["例如，监听 ",(0,d.jsx)(n.code,{children:"node_modules/"})," 目录且忽略 ",(0,d.jsx)(n.code,{children:".git/"})," 目录，可以配置为："]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    rspack: {\n      watchOptions: {\n        ignored: /\\.git/,\n      },\n    },\n  },\n};\n"})}),"\n",(0,d.jsxs)(n.h2,{id:"常见问题",children:["常见问题",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#常见问题",children:"#"})]}),"\n",(0,d.jsxs)(n.p,{children:["请参考 ",(0,d.jsx)(n.a,{href:"/guide/faq/hmr",children:"热更新问题"}),"。"]})]})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(l,{...e})}):l(e)}let h=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["zh%2Fguide%2Fadvanced%2Fhmr.mdx"]={toc:[{text:"HMR 开关",id:"hmr-开关",depth:2},{text:"自定义 HMR URL",id:"自定义-hmr-url",depth:2},{text:"文件监听",id:"文件监听",depth:2},{text:"常见问题",id:"常见问题",depth:2}],title:"模块热更新",frontmatter:{}}}}]);