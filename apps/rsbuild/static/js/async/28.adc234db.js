"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["28"],{41700:function(e,n,s){s.r(n),s.d(n,{default:function(){return h}});var r=s(55367),i=s(26971),d=s(28855),c=s(38146);function t(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",h3:"h3",code:"code",pre:"pre",ul:"ul",li:"li",strong:"strong",ol:"ol"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"assets-retry-插件",children:["Assets Retry 插件",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#assets-retry-插件",children:"#"})]}),"\n","\n",(0,r.jsx)(d.ZB,{href:"https://github.com/web-infra-dev/rsbuild/tree/main/packages/plugin-assets-retry"}),"\n",(0,r.jsx)(n.p,{children:"Assets Retry 插件用于在静态资源加载失败时自动发起重试请求。"}),"\n",(0,r.jsxs)(n.h2,{id:"快速开始",children:["快速开始",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#快速开始",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"安装插件",children:["安装插件",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安装插件",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"你可以通过如下的命令安装插件:"}),"\n","\n",(0,r.jsx)(c.PackageManagerTabs,{command:"add @rsbuild/plugin-assets-retry -D"}),"\n",(0,r.jsxs)(n.h3,{id:"注册插件",children:["注册插件",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#注册插件",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["你可以在 ",(0,r.jsx)(n.code,{children:"rsbuild.config.ts"})," 文件中注册插件："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { pluginAssetsRetry } from '@rsbuild/plugin-assets-retry';\n\nexport default {\n  plugins: [pluginAssetsRetry()],\n};\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"选项",children:["选项",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#选项",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"你可以通过选项来配置资源加载失败时的重试逻辑。"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"类型："})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type AssetsRetryHookContext = {\n  times: number;\n  domain: string;\n  url: string;\n  tagName: string;\n  isAsyncChunk: boolean;\n};\n\ntype AssetsRetryOptions = {\n  type?: string[];\n  domain?: string[];\n  max?: number;\n  test?: string | ((url: string) => boolean);\n  crossOrigin?: boolean | 'anonymous' | 'use-credentials';\n  inlineScript?: boolean;\n  onRetry?: (context: AssetsRetryHookContext) => void;\n  onSuccess?: (context: AssetsRetryHookContext) => void;\n  onFail?: (context: AssetsRetryHookContext) => void;\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"默认值："})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const defaultOptions = {\n  type: ['script', 'link', 'img'],\n  domain: [],\n  max: 3,\n  test: '',\n  crossOrigin: false,\n  onRetry: () => {},\n  onSuccess: () => {},\n  onFail: () => {},\n};\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"domain",children:["domain",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#domain",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"string[]"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"[]"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["指定资源加载失败时的重试域名列表。在 ",(0,r.jsx)(n.code,{children:"domain"})," 数组中，第一项是当前使用的域名，后面几项为备用域名。当某个域名的资源请求失败时，Rsbuild 会在数组中找到该域名，并替换为数组的下一个域名。"]}),"\n",(0,r.jsx)(n.p,{children:"比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  domain: ['https://cdn1.com', 'https://cdn2.com', 'https://cdn3.com'],\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["添加以上配置后，当 ",(0,r.jsx)(n.code,{children:"cdn1.com"})," 域名的资源加载失败时，请求域名会自动降级到 ",(0,r.jsx)(n.code,{children:"cdn2.com"}),"。"]}),"\n",(0,r.jsxs)(n.p,{children:["如果 ",(0,r.jsx)(n.code,{children:"cdn2.com"})," 的资源也请求失败，则会继续请求 ",(0,r.jsx)(n.code,{children:"cdn3.com"}),"。"]}),"\n",(0,r.jsxs)(n.h3,{id:"type",children:["type",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#type",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"string[]"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"['script', 'link', 'img']"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"用于指定需要进行重试的 HTML 标签类型。默认会处理 script 标签、link 标签和 img 标签，对应 JS 代码、CSS 代码和图片。"}),"\n",(0,r.jsx)(n.p,{children:"比如只对 script 标签和 link 标签进行处理："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  type: ['script', 'link'],\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"max",children:["max",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#max",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"number"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"3"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"单个资源的最大重试次数。比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  max: 5,\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"test",children:["test",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#test",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"string | ((url: string) => boolean) | undefined"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"undefined"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"匹配资源 URL 的正则表达式或函数，默认匹配所有资源。比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  test: /cdn\\.example\\.com/,\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"crossorigin",children:["crossOrigin",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#crossorigin",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"undefined | boolean | 'anonymous' | 'use-credentials'"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"与 html.crossorigin 一致"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["在发起资源重新请求时，Rsbuild 会重新创建 ",(0,r.jsx)(n.code,{children:"<script>"})," 标签，此选项可以设置这些标签的 ",(0,r.jsx)(n.code,{children:"crossorigin"})," 属性。"]}),"\n",(0,r.jsxs)(n.p,{children:["默认情况下，",(0,r.jsx)(n.code,{children:"crossOrigin"})," 的值会与 ",(0,r.jsx)(n.code,{children:"html.crossorigin"})," 配置项保持一致，无须额外配置。如果你需要对重新创建的标签进行单独配置，可以使用该选项，比如："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  crossOrigin: true,\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"onretry",children:["onRetry",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#onretry",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"undefined | (context: AssetsRetryHookContext) => void"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"资源重试时的回调函数。比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  onRetry: ({ times, domain, url, tagName, isAsyncChunk }) => {\n    console.log(\n      `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}, isAsyncChunk: ${isAsyncChunk}`,\n    );\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"onsuccess",children:["onSuccess",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#onsuccess",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"undefined | (context: AssetsRetryHookContext) => void"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"资源重试成功时的回调函数。比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  onSuccess: ({ times, domain, url, tagName, isAsyncChunk }) => {\n    console.log(\n      `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}, isAsyncChunk: ${isAsyncChunk}`,\n    );\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"onfail",children:["onFail",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#onfail",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"undefined | (context: AssetsRetryHookContext) => void"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"资源重试超过最大重试次数时的回调函数。比如："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  onFail: ({ times, domain, url, tagName, isAsyncChunk }) => {\n    console.log(\n      `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}, isAsyncChunk: ${isAsyncChunk}`,\n    );\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"addquery",children:["addQuery",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#addquery",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"类型："})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type AddQuery =\n  | boolean\n  | ((context: { times: number; originalQuery: string }) => string);\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"false"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"是否在资源重试时添加 query，这样可以避免被浏览器、CDN 缓存影响到重试的结果。"}),"\n",(0,r.jsxs)(n.p,{children:["当设置为 ",(0,r.jsx)(n.code,{children:"true"})," 时，请求时会在 query 中添加 ",(0,r.jsx)(n.code,{children:"retry=${times}"}),"，按照 ",(0,r.jsx)(n.code,{children:"retry=1"}),"，",(0,r.jsx)(n.code,{children:"retry=2"}),"，",(0,r.jsx)(n.code,{children:"retry=3"})," 依次请求，比如："]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["假设请求的静态资源为 ",(0,r.jsx)(n.code,{children:"https://js.cdn.net/foo.js"}),"，请求失败后会自动重试 ",(0,r.jsx)(n.code,{children:"https://js.cdn.net/foo.js?retry=${times}"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["假设请求的静态资源为 ",(0,r.jsx)(n.code,{children:"https://js.cdn.net/foo.js?version=1"}),"，请求失败后会自动重试 ",(0,r.jsx)(n.code,{children:"https://js.cdn.net/foo.js?version=1&retry=${times}"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"当你想要自定义 query 时，可以传入一个函数，比如："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"示例："})," 请求的所有资源都不含 query："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  addQuery: ({ times }) => {\n    return times === 3\n      ? `?retryCount=${times}&isLast=1`\n      : `?retryCount=${times}`;\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"示例："})," 当请求的某些资源中含有 query 时，可以使用 ",(0,r.jsx)(n.code,{children:"originalQuery"})," 读取："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  addQuery: ({ times, originalQuery }) => {\n    const query =\n      times === 3 ? `retryCount=${times}&isLast=1` : `retryCount=${times}`;\n    return originalQuery ? `${originalQuery}&${query}` : `?${query}`;\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"inlinescript",children:["inlineScript",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#inlinescript",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"boolean"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"true"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"是否将 Assets Retry 插件的运行时 JavaScript 代码内联到 HTML 文件中。"}),"\n",(0,r.jsxs)(n.p,{children:["如果你不希望在 HTML 文件中插入相关代码，可以将 ",(0,r.jsx)(n.code,{children:"inlineScript"})," 设置为 ",(0,r.jsx)(n.code,{children:"false"}),"："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  inlineScript: false,\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["添加以上配置后，Assets Retry 插件的运行时代码会被抽取为一个独立的 ",(0,r.jsx)(n.code,{children:"assets-retry.[version].js"})," 文件，并输出到产物目录下。"]}),"\n",(0,r.jsxs)(n.p,{children:["这种方式的弊端在于，",(0,r.jsx)(n.code,{children:"assets-retry.[version].js"})," 自身有加载失败的可能性。如果出现这种情况，静态资源重试的逻辑就无法生效。因此，我们更推荐将运行时代码内联到 HTML 文件中。"]}),"\n",(0,r.jsxs)(n.h3,{id:"minify",children:["minify",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#minify",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"boolean"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"默认值："})," ",(0,r.jsx)(n.code,{children:"process.env.NODE_ENV === 'production'"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"是否对运行时 JavaScript 代码开启代码压缩。"}),"\n",(0,r.jsxs)(n.p,{children:["默认情况下，会受到 ",(0,r.jsx)(n.a,{href:"/config/output/minify",children:"output.minify"})," 配置的影响。"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"pluginAssetsRetry({\n  minify: true,\n});\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"注意事项",children:["注意事项",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#注意事项",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"当你使用 Assets Retry 插件时，Rsbuild 会向 HTML 中注入一段运行时代码，并将 Assets Retry 插件配置的内容序列化，插入到这段代码中，因此你需要注意："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"避免在 Assets Retry 插件中配置敏感信息，比如内部使用的 token。"}),"\n",(0,r.jsxs)(n.li,{children:["避免在 ",(0,r.jsx)(n.code,{children:"onRetry"}),"，",(0,r.jsx)(n.code,{children:"onSuccess"}),"，",(0,r.jsx)(n.code,{children:"onFail"})," 中引用函数外部的变量或方法。"]}),"\n",(0,r.jsxs)(n.li,{children:["避免在 ",(0,r.jsx)(n.code,{children:"onRetry"}),"，",(0,r.jsx)(n.code,{children:"onSuccess"}),"，",(0,r.jsx)(n.code,{children:"onFail"})," 中使用有兼容性问题的语法，因为这些函数会被直接内联到 HTML 中。"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"以下是一个错误示例："}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"import { someMethod } from 'utils';\n\npluginAssetsRetry({\n  onRetry() {\n    // 错误用法，包含了敏感信息\n    const privateToken = 'a-private-token';\n\n    // 错误用法，使用了外部的方法\n    someMethod(privateToken);\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"使用限制",children:["使用限制",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#使用限制",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"以下场景 Assets Retry 插件可能无法生效："}),"\n",(0,r.jsxs)(n.h3,{id:"模块联邦",children:["模块联邦",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模块联邦",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["对于模块联邦加载的远程模块，你可以使用模块联邦 2.0 的 ",(0,r.jsx)(n.a,{href:"https://www.npmjs.com/package/@module-federation/retry-plugin",target:"_blank",rel:"noopener noreferrer",children:"@module-federation/retry-plugin"})," 来实现静态资源重试。"]}),"\n",(0,r.jsxs)(n.h3,{id:"微前端",children:["微前端",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#微前端",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["如果你的工程是微前端应用（比如 Garfish 子应用），那么 Assets Retry 插件可能无法生效，因为微前端子应用通常不是基于 ",(0,r.jsx)(n.code,{children:"<script>"})," 标签直接加载的。"]}),"\n",(0,r.jsx)(n.p,{children:"如果你需要对微前端场景的资源加载进行重试，请联系微前端框架的开发者，以寻找相应的解决方案。"}),"\n",(0,r.jsxs)(n.h3,{id:"自定义模版中的资源",children:["自定义模版中的资源",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#自定义模版中的资源",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Assets Retry 插件通过监听页面 error 事件来获悉当前资源是否加载失败需要重试。因此，如果自定义模版中的资源执行早于 Assets Retry 插件，那 Assets Retry 插件无法监听到该资源加载失败的事件，retry 无法对其生效。"}),"\n",(0,r.jsxs)(n.p,{children:["如果想要 Assets Retry 插件对自定义模版中的资源生效，可参考 ",(0,r.jsx)(n.a,{href:"https://github.com/rspack-contrib/html-rspack-plugin/tree/main/examples/custom-insertion-position",target:"_blank",rel:"noopener noreferrer",children:"自定义插入示例"})," 来修改 ",(0,r.jsx)(n.a,{href:"/config/html/inject",children:"html.inject"})," 配置和自定义模版。"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-diff",children:'<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8">\n    <title>custom template</title>\n+   <%= htmlPlugin.tags.headTags %>\n    <script src="https://example.com/assets/a.js"><\/script>\n  </head>\n  <body>\n    <div id="root" />\n+    <%= htmlPlugin.tags.bodyTags %>\n  </body>\n</html>\n'})})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}let h=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["zh%2Fplugins%2Flist%2Fplugin-assets-retry.mdx"]={toc:[{text:"快速开始",id:"快速开始",depth:2},{text:"安装插件",id:"安装插件",depth:3},{text:"注册插件",id:"注册插件",depth:3},{text:"选项",id:"选项",depth:2},{text:"domain",id:"domain",depth:3},{text:"type",id:"type",depth:3},{text:"max",id:"max",depth:3},{text:"test",id:"test",depth:3},{text:"crossOrigin",id:"crossorigin",depth:3},{text:"onRetry",id:"onretry",depth:3},{text:"onSuccess",id:"onsuccess",depth:3},{text:"onFail",id:"onfail",depth:3},{text:"addQuery",id:"addquery",depth:3},{text:"inlineScript",id:"inlinescript",depth:3},{text:"minify",id:"minify",depth:3},{text:"注意事项",id:"注意事项",depth:2},{text:"使用限制",id:"使用限制",depth:2},{text:"模块联邦",id:"模块联邦",depth:3},{text:"微前端",id:"微前端",depth:3},{text:"自定义模版中的资源",id:"自定义模版中的资源",depth:3}],title:"Assets Retry 插件",frontmatter:{}}}}]);