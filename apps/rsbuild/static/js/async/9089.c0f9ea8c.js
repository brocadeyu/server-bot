"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["9089"],{83743:function(e,n,d){d.r(n),d.d(n,{default:function(){return l}});var r=d(55367),i=d(26971);function s(e){let n=Object.assign({h1:"h1",a:"a",ul:"ul",li:"li",strong:"strong",code:"code",p:"p",div:"div",h2:"h2",pre:"pre",h3:"h3"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"mode",children:["mode",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mode",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"类型："})," ",(0,r.jsx)(n.code,{children:"'production' | 'development' | 'none'"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"版本："})," ",(0,r.jsx)(n.code,{children:">= 1.0.0"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["指定 Rsbuild 构建的模式，各个模式默认的行为和优化不同，比如 ",(0,r.jsx)(n.code,{children:"production"})," 模式默认会压缩代码。"]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild ",(0,r.jsx)(n.code,{children:"mode"})," 的值也会传递给 Rspack 的 ",(0,r.jsx)(n.a,{href:"https://rspack.dev/config/mode",target:"_blank",rel:"noopener noreferrer",children:"mode"})," 配置。"]}),"\n",(0,r.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsxs)(n.div,{className:"rspress-directive-content",children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"mode"})," 的值不会影响 ",(0,r.jsx)(n.code,{children:".env"})," 文件的加载结果， 因为 ",(0,r.jsx)(n.code,{children:".env"})," 文件早于 Rsbuild 的配置文件被解析。"]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild CLI 支持使用 ",(0,r.jsx)(n.code,{children:"--env-mode"})," 选项来指定 env 模式，详见 ",(0,r.jsx)(n.a,{href:"/guide/advanced/env-vars#env-%E6%A8%A1%E5%BC%8F",children:'"Env 模式"'}),"。\n"]})]})]}),"\n",(0,r.jsxs)(n.h2,{id:"默认值",children:["默认值",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#默认值",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"mode"})," 的默认值取决于 ",(0,r.jsx)(n.code,{children:"process.env.NODE_ENV"})," 环境变量："]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["如果 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 为 ",(0,r.jsx)(n.code,{children:"production"}),"，则默认值为 ",(0,r.jsx)(n.code,{children:"production"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["如果 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 为 ",(0,r.jsx)(n.code,{children:"development"}),"，则默认值为 ",(0,r.jsx)(n.code,{children:"development"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["如果 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 为其他值，则默认值为 ",(0,r.jsx)(n.code,{children:"none"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["如果你设置了 ",(0,r.jsx)(n.code,{children:"mode"})," 的值，则 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 的值会被忽略。"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  mode: 'production',\n};\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"命令行",children:["命令行",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#命令行",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"当你使用 Rsbuild 的命令行时："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rsbuild dev"})," 会将 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 和 ",(0,r.jsx)(n.code,{children:"mode"})," 的默认值设置为 ",(0,r.jsx)(n.code,{children:"development"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rsbuild build"})," 和 ",(0,r.jsx)(n.code,{children:"rsbuild preview"})," 会将 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 和 ",(0,r.jsx)(n.code,{children:"mode"})," 的默认值设置为 ",(0,r.jsx)(n.code,{children:"production"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"javascript-api",children:["JavaScript API",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#javascript-api",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"当你使用 Rsbuild 的 JavaScript API 时："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/api/javascript-api/instance#rsbuildstartdevserver",children:"rsbuild.startDevServer"})," 和 ",(0,r.jsx)(n.a,{href:"/api/javascript-api/instance#rsbuildcreatedevserver",children:"rsbuild.createDevServer"})," 会将 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 和 ",(0,r.jsx)(n.code,{children:"mode"})," 的默认值设置为 ",(0,r.jsx)(n.code,{children:"development"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/api/javascript-api/instance#rsbuildbuild",children:"rsbuild.build"})," 和 ",(0,r.jsx)(n.a,{href:"/api/javascript-api/instance#rsbuildpreview",children:"rsbuild.preview"})," 会将 ",(0,r.jsx)(n.code,{children:"NODE_ENV"})," 和 ",(0,r.jsx)(n.code,{children:"mode"})," 的默认值设置为 ",(0,r.jsx)(n.code,{children:"production"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"development-模式",children:["Development 模式",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#development-模式",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["当 ",(0,r.jsx)(n.code,{children:"mode"})," 的值为 ",(0,r.jsx)(n.code,{children:"development"})," 时："]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["开启 HMR，注册 ",(0,r.jsx)(n.a,{href:"https://rspack.dev/plugins/webpack/hot-module-replacement-plugin",target:"_blank",rel:"noopener noreferrer",children:"HotModuleReplacementPlugin"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["生成 JavaScript 的 source map，不生成 CSS 的 source map，详见 ",(0,r.jsx)(n.a,{href:"/config/output/source-map",children:"output.sourceMap"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"process.env.NODE_ENV"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"'development'"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.MODE"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"'development'"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.DEV"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"true"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.PROD"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"false"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"production-模式",children:["Production 模式",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#production-模式",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["当 ",(0,r.jsx)(n.code,{children:"mode"})," 的值为 ",(0,r.jsx)(n.code,{children:"production"})," 时："]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["开启 JavaScript 代码压缩，注册 ",(0,r.jsx)(n.a,{href:"https://rspack.dev/plugins/rspack/swc-js-minimizer-rspack-plugin",target:"_blank",rel:"noopener noreferrer",children:"SwcJsMinimizerRspackPlugin"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["开启 CSS 代码压缩，注册 ",(0,r.jsx)(n.a,{href:"https://rspack.dev/plugins/rspack/lightning-css-minimizer-rspack-plugin",target:"_blank",rel:"noopener noreferrer",children:"LightningCssMinimizerRspackPlugin"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["生成的 JavaScript 和 CSS 文件名会带有 hash 后缀，详见 ",(0,r.jsx)(n.a,{href:"/config/output/filename-hash",children:"output.filenameHash"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["生成的 CSS Modules 类名更简短，详见 ",(0,r.jsx)(n.a,{href:"/config/output/css-modules#cssmoduleslocalidentname",children:"cssModules.localIdentName"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["不生成 JavaScript 和 CSS 的 source map，详见 ",(0,r.jsx)(n.a,{href:"/config/output/source-map",children:"output.sourceMap"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"process.env.NODE_ENV"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"'production'"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.MODE"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"'production'"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.DEV"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"false"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.PROD"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"true"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"none-模式",children:["None 模式",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#none-模式",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["当 ",(0,r.jsx)(n.code,{children:"mode"})," 的值为 ",(0,r.jsx)(n.code,{children:"none"})," 时："]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"不开启任何优化。"}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"process.env.NODE_ENV"})," 不会被替换。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.MODE"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"'none'"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.DEV"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"false"}),"。"]}),"\n",(0,r.jsxs)(n.li,{children:["源代码中的 ",(0,r.jsx)(n.code,{children:"import.meta.env.PROD"})," 会被替换为 ",(0,r.jsx)(n.code,{children:"false"}),"。"]}),"\n"]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(s,{...e})}):s(e)}let l=c;c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["zh%2Fconfig%2Fmode.mdx"]={toc:[{text:"默认值",id:"默认值",depth:2},{text:"命令行",id:"命令行",depth:3},{text:"JavaScript API",id:"javascript-api",depth:3},{text:"Development 模式",id:"development-模式",depth:2},{text:"Production 模式",id:"production-模式",depth:2},{text:"None 模式",id:"none-模式",depth:2}],title:"mode",frontmatter:{}}}}]);