"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["9203"],{19723:function(e,r,n){n.r(r),n.d(r,{default:function(){return t}});var s=n(55367),i=n(26971),l=n(38146);function c(e){let r=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",div:"div",code:"code",pre:"pre",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",blockquote:"blockquote"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.h1,{id:"vue-cli",children:["Vue CLI",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#vue-cli",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["本章节介绍如何将 ",(0,s.jsx)(r.a,{href:"https://github.com/vuejs/vue-cli",target:"_blank",rel:"noopener noreferrer",children:"Vue CLI"})," 项目迁移到 Rsbuild。"]}),"\n",(0,s.jsxs)(r.h2,{id:"安装依赖",children:["安装依赖",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#安装依赖",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"首先你需要把 Vue CLI 的 npm 依赖替换为 Rsbuild 的依赖。"}),"\n","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"移除 Vue CLI 的依赖："}),"\n"]}),"\n",(0,s.jsx)(l.PackageManagerTabs,{command:"remove @vue/cli-service @vue/cli-plugin-babel @vue/cli-plugin-eslint core-js"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"安装 Rsbuild 的依赖："}),"\n"]}),"\n",(0,s.jsx)(l.PackageManagerTabs,{command:"add @rsbuild/core @rsbuild/plugin-vue -D"}),"\n",(0,s.jsxs)(r.div,{className:"rspress-directive tip",children:[(0,s.jsx)(r.div,{className:"rspress-directive-title",children:"TIP"}),(0,s.jsx)(r.div,{className:"rspress-directive-content",children:(0,s.jsxs)(r.p,{children:["如果你的项目是基于 Vue 2 的，请将 ",(0,s.jsx)(r.code,{children:"@rsbuild/plugin-vue"})," 替换为 ",(0,s.jsx)(r.code,{children:"@rsbuild/plugin-vue2"}),"。\n"]})})]}),"\n",(0,s.jsxs)(r.h2,{id:"更新-npm-scripts",children:["更新 npm scripts",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#更新-npm-scripts",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"下一步，你需要把 package.json 中的 npm scripts 更新为 Rsbuild 的 CLI 命令。"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-diff",meta:'title="package.json"',children:'{\n  "scripts": {\n-   "serve": "vue-cli-service serve",\n-   "build": "vue-cli-service build",\n+   "serve": "rsbuild dev",\n+   "build": "rsbuild build",\n+   "preview": "rsbuild preview"\n  }\n}\n'})}),"\n",(0,s.jsxs)(r.div,{className:"rspress-directive tip",children:[(0,s.jsx)(r.div,{className:"rspress-directive-title",children:"TIP"}),(0,s.jsx)(r.div,{className:"rspress-directive-content",children:(0,s.jsxs)(r.p,{children:["Rsbuild 未集成 ESLint，因此没有提供用于替换 ",(0,s.jsx)(r.code,{children:"vue-cli-service lint"})," 的命令，你可以直接使用 ESLint 的 ",(0,s.jsx)(r.a,{href:"https://eslint.org/docs/latest/use/command-line-interface",target:"_blank",rel:"noopener noreferrer",children:"CLI 命令"})," 作为替代。\n"]})})]}),"\n",(0,s.jsxs)(r.h2,{id:"创建配置文件",children:["创建配置文件",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#创建配置文件",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["在 package.json 的同级目录下创建 Rsbuild 的配置文件 ",(0,s.jsx)(r.code,{children:"rsbuild.config.ts"}),"，并添加以下内容："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { defineConfig } from '@rsbuild/core';\nimport { pluginVue } from '@rsbuild/plugin-vue';\n\nexport default defineConfig({\n  plugins: [pluginVue()],\n  source: {\n    // 指定入口文件\n    entry: {\n      index: './src/main.js',\n    },\n  },\n});\n"})}),"\n",(0,s.jsxs)(r.div,{className:"rspress-directive tip",children:[(0,s.jsx)(r.div,{className:"rspress-directive-title",children:"TIP"}),(0,s.jsx)(r.div,{className:"rspress-directive-content",children:(0,s.jsxs)(r.p,{children:["如果你的项目是基于 Vue 2 的，请使用 ",(0,s.jsx)(r.code,{children:"import { pluginVue2 } from '@rsbuild/plugin-vue2';"}),"。\n"]})})]}),"\n",(0,s.jsxs)(r.h2,{id:"html-模板",children:["HTML 模板",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#html-模板",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["Vue CLI 默认使用 ",(0,s.jsx)(r.code,{children:"public/index.html"})," 文件作为 HTML 模板。在 Rsbuild 中，你可以通过 ",(0,s.jsx)(r.a,{href:"/config/html/template",children:"html.template"})," 来指定 HTML 模板："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default defineConfig({\n  html: {\n    template: './public/index.html',\n  },\n});\n"})}),"\n",(0,s.jsxs)(r.p,{children:["在 HTML 模板中，如果使用了 Vue CLI 的 ",(0,s.jsx)(r.code,{children:"BASE_URL"})," 变量，请替换为 Rsbuild 的 ",(0,s.jsx)(r.a,{href:"/config/html/template-parameters",children:"assetPrefix 变量"}),"，并使用斜杠进行连接："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-diff",children:'-  <link rel="icon" href="<%= BASE_URL %>favicon.ico">\n+  <link rel="icon" href="<%= assetPrefix %>/favicon.ico">\n'})}),"\n",(0,s.jsxs)(r.p,{children:["这样就完成了从 Vue CLI 到 Rsbuild 的基本迁移，此时你可以执行 ",(0,s.jsx)(r.code,{children:"npm run serve"})," 命令来尝试启动开发服务器。"]}),"\n",(0,s.jsxs)(r.h2,{id:"配置迁移",children:["配置迁移",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#配置迁移",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"以下是 Vue CLI 配置对应的 Rsbuild 配置："}),"\n",(0,s.jsxs)(r.table,{children:["\n",(0,s.jsxs)(r.thead,{children:["\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.th,{children:"Vue CLI"}),"\n",(0,s.jsx)(r.th,{children:"Rsbuild"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.tbody,{children:["\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#publicpath",target:"_blank",rel:"noopener noreferrer",children:"publicPath"})}),"\n",(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.a,{href:"/config/dev/asset-prefix",children:"dev.assetPrefix"})," / ",(0,s.jsx)(r.a,{href:"/config/output/asset-prefix",children:"output.assetPrefix"})]}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#outputdir",target:"_blank",rel:"noopener noreferrer",children:"outputDir"})," / ",(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#assetsdir",target:"_blank",rel:"noopener noreferrer",children:"assetsDir"})]}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/output/dist-path",children:"output.distPath"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#filenamehashing",target:"_blank",rel:"noopener noreferrer",children:"filenameHashing"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/output/filename-hash",children:"output.filenameHash"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#pages",target:"_blank",rel:"noopener noreferrer",children:"pages"})}),"\n",(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.a,{href:"/config/source/entry",children:"source.entry"})," / ",(0,s.jsx)(r.a,{href:"/config/html/template",children:"html.template"})," / ",(0,s.jsx)(r.a,{href:"/config/html/title",children:"html.title"})]}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#transpiledependencies",target:"_blank",rel:"noopener noreferrer",children:"transpileDependencies"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/source/include",children:"source.include"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#productionsourcemap",target:"_blank",rel:"noopener noreferrer",children:"productionSourceMap"})," / ",(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#css-sourcemap",target:"_blank",rel:"noopener noreferrer",children:"css.sourceMap"})]}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/output/source-map",children:"output.sourceMap"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#crossorigin",target:"_blank",rel:"noopener noreferrer",children:"crossorigin"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/html/crossorigin",children:"html.crossorigin"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#configurewebpack",target:"_blank",rel:"noopener noreferrer",children:"configureWebpack"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/tools/rspack",children:"tools.rspack"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#chainwebpack",target:"_blank",rel:"noopener noreferrer",children:"chainWebpack"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/tools/bundler-chain",children:"tools.bundlerChain"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#css-extract",target:"_blank",rel:"noopener noreferrer",children:"css.extract"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/output/inject-styles",children:"output.injectStyles"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#css-loaderoptions",target:"_blank",rel:"noopener noreferrer",children:"css.loaderOptions"})}),"\n",(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.a,{href:"/config/tools/css-loader",children:"tools.cssLoader"})," / ",(0,s.jsx)(r.a,{href:"/plugins/list/plugin-less",children:"less"})," / ",(0,s.jsx)(r.a,{href:"/plugins/list/plugin-sass",children:"sass"})," / ",(0,s.jsx)(r.a,{href:"/config/tools/postcss",children:"postcss"})]}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://cli.vuejs.org/config/#devserver-proxy",target:"_blank",rel:"noopener noreferrer",children:"devServer.proxy"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/config/server/proxy",children:"server.proxy"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"说明："}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"在迁移 configureWebpack 时，注意大部分 Webpack 和 Rspack 配置是相同的，但也存在一些差异或 Rspack 未实现的功能。"}),"\n",(0,s.jsx)(r.li,{children:"上述表格尚未覆盖到 Vue CLI 的所有配置，欢迎补充。"}),"\n"]}),"\n",(0,s.jsxs)(r.h2,{id:"环境变量",children:["环境变量",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#环境变量",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["Vue CLI 默认会将 ",(0,s.jsx)(r.code,{children:"VUE_APP_"})," 开头的环境变量注入到 client 代码中，而 Rsbuild 默认会注入 ",(0,s.jsx)(r.code,{children:"PUBLIC_"})," 开头的环境变量（参考 ",(0,s.jsx)(r.a,{href:"/guide/advanced/env-vars#public-%E5%8F%98%E9%87%8F",children:"public 变量"}),"）。"]}),"\n",(0,s.jsxs)(r.p,{children:["为了兼容 Vue CLI 的行为，你可以手动调用 Rsbuild 提供的 ",(0,s.jsx)(r.a,{href:"/api/javascript-api/core#loadenv",children:"loadEnv"})," 方法来读取 ",(0,s.jsx)(r.code,{children:"VUE_APP_"})," 开头的环境变量，并通过 ",(0,s.jsx)(r.a,{href:"/config/source/define",children:"source.define"})," 配置项注入到 client 代码中。"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { defineConfig, loadEnv } from '@rsbuild/core';\n\nconst { publicVars } = loadEnv({ prefixes: ['VUE_APP_'] });\n\nexport default defineConfig({\n  source: {\n    define: publicVars,\n  },\n});\n"})}),"\n",(0,s.jsxs)(r.h2,{id:"内容补充",children:["内容补充",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#内容补充",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"当前文档只涵盖了迁移过程的部分事项，如果你发现有合适的内容可以补充，欢迎通过 pull request 来完善文档 \uD83E\uDD1D。"}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsxs)(r.p,{children:["Rsbuild 的文档位于 ",(0,s.jsx)(r.a,{href:"https://github.com/web-infra-dev/rsbuild/tree/main/website",target:"_blank",rel:"noopener noreferrer",children:"rsbuild/website"})," 目录。"]}),"\n"]})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,i.ah)(),e.components);return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}let t=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["zh%2Fguide%2Fmigration%2Fvue-cli.mdx"]={toc:[{text:"安装依赖",id:"安装依赖",depth:2},{text:"更新 npm scripts",id:"更新-npm-scripts",depth:2},{text:"创建配置文件",id:"创建配置文件",depth:2},{text:"HTML 模板",id:"html-模板",depth:2},{text:"配置迁移",id:"配置迁移",depth:2},{text:"环境变量",id:"环境变量",depth:2},{text:"内容补充",id:"内容补充",depth:2}],title:"Vue CLI",frontmatter:{}}}}]);