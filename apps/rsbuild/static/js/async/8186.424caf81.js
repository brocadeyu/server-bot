"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["8186"],{520:function(e,r,s){s.r(r),s.d(r,{default:function(){return a}});var n=s(55367),d=s(26971);function i(e){let r=Object.assign({h1:"h1",a:"a",p:"p",code:"code",h2:"h2",pre:"pre",img:"img",h3:"h3",ul:"ul",li:"li",strong:"strong",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",blockquote:"blockquote"},(0,d.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.h1,{id:"server",children:["Server",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#server",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["Rsbuild comes with a built-in dev server designed to improve the development experience. When you run the ",(0,n.jsx)(r.code,{children:"rsbuild dev"})," or ",(0,n.jsx)(r.code,{children:"rsbuild preview"})," commands, the server will start, providing features such as page preview, routing, and hot module reloading."]}),"\n",(0,n.jsxs)(r.h2,{id:"base-path",children:["Base Path",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#base-path",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["By default, the base path of the server is ",(0,n.jsx)(r.code,{children:"/"}),", and users can access output files such as ",(0,n.jsx)(r.code,{children:"index.html"})," and public folder assets through ",(0,n.jsx)(r.a,{href:"http://localhost:3000/",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:3000/"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["Rsbuild supports modifying the base path of the server through ",(0,n.jsx)(r.a,{href:"/config/server/base",children:"server.base"}),". If you to access these files through ",(0,n.jsx)(r.code,{children:"http://localhost:3000/foo/"}),", you can configure the following:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  server: {\n    base: '/foo',\n  },\n};\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"view-static-assets",children:["View Static Assets",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#view-static-assets",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["After starting the dev server, you can access ",(0,n.jsx)(r.code,{children:"/rsbuild-dev-server"})," to view all static assets generated during the current build."]}),"\n",(0,n.jsxs)(r.p,{children:["For example, open ",(0,n.jsx)(r.code,{children:"http://localhost:3000/rsbuild-dev-server"})," in the browser, you will see:"]}),"\n",(0,n.jsx)("img",{src:"https://assets.rspack.dev/rsbuild/assets/assets-report-page.png",alt:"rsbuild-dev-server",width:"600"}),"\n",(0,n.jsxs)(r.h2,{id:"page-routing",children:["Page Routing",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#page-routing",children:"#"})]}),"\n",(0,n.jsx)(r.p,{children:"Rsbuild Server offers a set of default routing convention, and allows users to customize it through configurations."}),"\n",(0,n.jsxs)(r.h3,{id:"default-behavior",children:["Default Behavior",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#default-behavior",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["Rsbuild Server will generate the corresponding page route based on the ",(0,n.jsx)(r.a,{href:"/config/server/base",children:"server.base"})," and ",(0,n.jsx)(r.a,{href:"/config/source/entry",children:"source.entry"})," configurations."]}),"\n",(0,n.jsxs)(r.p,{children:["When entry is index, the page can be accessed through ",(0,n.jsx)(r.code,{children:"/"}),"; when entry is foo, the page can be accessed through ",(0,n.jsx)(r.code,{children:"/foo"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["When server.base is ",(0,n.jsx)(r.code,{children:"/base"}),", the index page can be accessed through ",(0,n.jsx)(r.code,{children:"/base"})," and the foo page can be accessed through ",(0,n.jsx)(r.code,{children:"/base/foo"}),"."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",meta:"title=rsbuild.config.ts",children:"export default {\n  source: {\n    entry: {\n      index: './src/index.ts',\n      foo: './src/pages/foo/index.ts',\n    },\n  },\n};\n"})}),"\n",(0,n.jsxs)(r.h3,{id:"fallback-behavior",children:["Fallback Behavior",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#fallback-behavior",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["By default, when the request meets the following conditions and the corresponding resource is not found, it will fallback to ",(0,n.jsx)(r.code,{children:"index.html"}),":"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["The request is a ",(0,n.jsx)(r.code,{children:"GET"})," or ",(0,n.jsx)(r.code,{children:"HEAD"})," request"]}),"\n",(0,n.jsxs)(r.li,{children:["Which accepts ",(0,n.jsx)(r.code,{children:"text/html"})," (the request header accept type is ",(0,n.jsx)(r.code,{children:"text/html"})," or ",(0,n.jsx)(r.code,{children:"*/*"}),")"]}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",meta:"title=rsbuild.config.ts",children:"export default {\n  server: {\n    htmlFallback: 'index',\n  },\n};\n"})}),"\n",(0,n.jsxs)(r.h3,{id:"custom-fallback-behavior",children:["Custom Fallback Behavior",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#custom-fallback-behavior",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["When Rsbuild's default ",(0,n.jsx)(r.a,{href:"/config/server/html-fallback",children:"server.htmlFallback"})," configuration cannot meet your needs, for example, if you want to be able to access ",(0,n.jsx)(r.code,{children:"main.html"})," when accessing ",(0,n.jsx)(r.code,{children:"/"}),", you can set it up using ",(0,n.jsx)(r.a,{href:"/config/server/history-api-fallback",children:"server.historyApiFallback"}),"."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",meta:"title=rsbuild.config.ts",children:"export default {\n  source: {\n    entry: {\n      main: './src/index.ts',\n    },\n  },\n  server: {\n    htmlFallback: false,\n    historyApiFallback: {\n      index: '/main.html',\n    },\n  },\n};\n"})}),"\n",(0,n.jsxs)(r.h3,{id:"html-output-path",children:["HTML Output Path",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#html-output-path",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["Normally, ",(0,n.jsx)(r.code,{children:"/"})," points to the dist root directory, and the HTML file is output to the dist root directory. At this time, the corresponding HTML page can be accessed through ",(0,n.jsx)(r.code,{children:"/some-path"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["If you output HTML files to other subdirectories by modifying ",(0,n.jsx)(r.a,{href:"/config/output/dist-path",children:"output.distPath.html"}),", you need to access the corresponding HTML page through ",(0,n.jsx)(r.code,{children:"/[htmlPath]/some-path"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["For example, if you set the HTML file to be output to the ",(0,n.jsx)(r.code,{children:"HTML"})," directory, index.html will be accessed through ",(0,n.jsx)(r.code,{children:"/html/"}),", and foo.html will be accessed through ",(0,n.jsx)(r.code,{children:"/html/foo"}),"."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",children:"export default {\n  source: {\n    entry: {\n      index: './src/index.ts',\n      foo: './src/pages/foo/index.ts',\n    },\n  },\n  output: {\n    distPath: {\n      html: 'html',\n    },\n  },\n};\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"rspack-dev-server",children:["Rspack Dev Server",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#rspack-dev-server",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["The built-in dev server of Rspack CLI is ",(0,n.jsx)(r.a,{href:"https://www.npmjs.com/package/@rspack/dev-server",target:"_blank",rel:"noopener noreferrer",children:"@rspack/dev-server"}),". Rsbuild does not use ",(0,n.jsx)(r.code,{children:"@rspack/dev-server"}),", but instead implemented its own more lightweight version."]}),"\n",(0,n.jsxs)(r.h3,{id:"comparison",children:["Comparison",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#comparison",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["The dev server of Rsbuild and ",(0,n.jsx)(r.code,{children:"@rspack/dev-server"})," have the following differences:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Configuration"}),": Rsbuild provides richer server configuration options."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Log Format"}),": The log format of Rspack CLI is basically consistent with Webpack CLI, while Rsbuild's logs are clearer and more readable."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Dependencies"}),": ",(0,n.jsx)(r.code,{children:"@rspack/dev-server"})," is based on express with many third-party dependencies. Rsbuild, on the other hand, uses lighter libraries such as ",(0,n.jsx)(r.code,{children:"connect"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(r.h3,{id:"configuration",children:["Configuration",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["Rsbuild does not support using Rspack's ",(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server",target:"_blank",rel:"noopener noreferrer",children:"devServer"})," config. Instead, you can use Rsbuild's ",(0,n.jsx)(r.code,{children:"dev"})," and ",(0,n.jsx)(r.code,{children:"server"})," configs."]}),"\n",(0,n.jsxs)(r.p,{children:["In Rsbuild, ",(0,n.jsx)(r.code,{children:"dev"})," contains some configs that are only work in development mode, while the ",(0,n.jsx)(r.code,{children:"server"})," config works for both dev and preview servers."]}),"\n",(0,n.jsxs)(r.p,{children:["Below are the Rsbuild configs that correspond to the Rspack CLI's ",(0,n.jsx)(r.code,{children:"devServer"})," config:"]}),"\n",(0,n.jsxs)(r.table,{children:["\n",(0,n.jsxs)(r.thead,{children:["\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.th,{children:"Rspack CLI"}),"\n",(0,n.jsx)(r.th,{children:"Rsbuild"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.tbody,{children:["\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverclient",target:"_blank",rel:"noopener noreferrer",children:"devServer.client"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/dev/client",children:"dev.client"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devservercompress",target:"_blank",rel:"noopener noreferrer",children:"devServer.compress"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/compress",children:"server.compress"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverheaders",target:"_blank",rel:"noopener noreferrer",children:"devServer.headers"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/headers",children:"server.headers"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverhistoryapifallback",target:"_blank",rel:"noopener noreferrer",children:"devServer.historyApiFallback"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/history-api-fallback",children:"server.historyApiFallback"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverhost",target:"_blank",rel:"noopener noreferrer",children:"devServer.host"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/host",children:"server.host"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverhot",target:"_blank",rel:"noopener noreferrer",children:"devServer.hot"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/dev/hmr",children:"dev.hmr"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverlivereload",target:"_blank",rel:"noopener noreferrer",children:"devServer.liveReload"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/dev/live-reload",children:"dev.liveReload"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserveropen",target:"_blank",rel:"noopener noreferrer",children:"devServer.open"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/open",children:"server.open"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverport",target:"_blank",rel:"noopener noreferrer",children:"devServer.port"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/port",children:"server.port"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverproxy",target:"_blank",rel:"noopener noreferrer",children:"devServer.proxy"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/proxy",children:"server.proxy"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserversetupmiddlewares",target:"_blank",rel:"noopener noreferrer",children:"devServer.setupMiddlewares"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/dev/setup-middlewares",children:"dev.setupMiddlewares"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverstatic",target:"_blank",rel:"noopener noreferrer",children:"devServer.static"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/server/public-dir",children:"server.publicDir"})}),"\n"]}),"\n",(0,n.jsxs)(r.tr,{children:["\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://rspack.dev/config/dev-server#devserverwatchfiles",target:"_blank",rel:"noopener noreferrer",children:"devServer.watchFiles"})}),"\n",(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"/config/dev/watch-files",children:"dev.watchFiles"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.blockquote,{children:["\n",(0,n.jsxs)(r.p,{children:["For more configurations, please refer to ",(0,n.jsx)(r.a,{href:"/config/index",children:"Config Overview"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(r.h2,{id:"extend-middleware",children:["Extend middleware",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#extend-middleware",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["Rsbuild server does not use any Node.js frameworks, and the ",(0,n.jsx)(r.code,{children:"req"})," and ",(0,n.jsx)(r.code,{children:"res"})," provided by Rsbuild middleware are both native Node.js objects."]}),"\n",(0,n.jsxs)(r.p,{children:["This means that when you migrate from other server-side frameworks (such as Express), the original middleware may not necessarily be used directly in Rsbuild. For example, the ",(0,n.jsx)(r.code,{children:"req.params"}),",",(0,n.jsx)(r.code,{children:"req.path"}),", ",(0,n.jsx)(r.code,{children:"req.search"}),", ",(0,n.jsx)(r.code,{children:"req.query"})," and other properties provided by Express cannot be accessed in the Rsbuild middleware."]}),"\n",(0,n.jsx)(r.p,{children:"If you need to use existing middleware in Rsbuild, this can be done by passing the server application as middleware as follows:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import expressMiddleware from 'my-express-middleware';\nimport express from 'express';\n\n// Initialize Express app\nconst app = express();\n\napp.use(expressMiddleware);\n\nexport default {\n  dev: {\n    setupMiddlewares: [\n      (middleware) => {\n        middleware.unshift(app);\n      },\n    ],\n  },\n};\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"custom-server",children:["Custom Server",(0,n.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#custom-server",children:"#"})]}),"\n",(0,n.jsxs)(r.p,{children:["If you want to integrate Rsbuild dev server into a custom server, you can get the instance methods of Rsbuild dev server through the ",(0,n.jsx)(r.code,{children:"createDevServer"})," method of Rsbuild and call them on demand."]}),"\n",(0,n.jsxs)(r.p,{children:["For details, please refer to ",(0,n.jsx)(r.a,{href:"/api/javascript-api/instance#rsbuildcreatedevserver",children:"Rsbuild - createDevServer"}),"."]})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,d.ah)(),e.components);return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(i,{...e})}):i(e)}let a=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["en%2Fguide%2Fbasic%2Fserver.mdx"]={toc:[{text:"Base Path",id:"base-path",depth:2},{text:"View Static Assets",id:"view-static-assets",depth:2},{text:"Page Routing",id:"page-routing",depth:2},{text:"Default Behavior",id:"default-behavior",depth:3},{text:"Fallback Behavior",id:"fallback-behavior",depth:3},{text:"Custom Fallback Behavior",id:"custom-fallback-behavior",depth:3},{text:"HTML Output Path",id:"html-output-path",depth:3},{text:"Rspack Dev Server",id:"rspack-dev-server",depth:2},{text:"Comparison",id:"comparison",depth:3},{text:"Configuration",id:"configuration",depth:3},{text:"Extend middleware",id:"extend-middleware",depth:2},{text:"Custom Server",id:"custom-server",depth:2}],title:"Server",frontmatter:{}}}}]);