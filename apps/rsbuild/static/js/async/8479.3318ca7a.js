"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["8479"],{319:function(e,n,i){i.r(n),i.d(n,{default:function(){return c}});var r=i(55367),s=i(26971),o=i(80493);function d(e){let n=Object.assign({h1:"h1",a:"a",p:"p",code:"code",div:"div",h2:"h2",pre:"pre",blockquote:"blockquote",h3:"h3",ul:"ul",li:"li",h4:"h4",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,s.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"configure-rspack",children:["Configure Rspack",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-rspack",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild supports directly modifying the Rspack configuration object, and also supports modifying the built-in Rspack configuration of Rsbuild through ",(0,r.jsx)(n.code,{children:"rspack-chain"}),"."]}),"\n",(0,r.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(n.div,{className:"rspress-directive-content",children:(0,r.jsx)(n.p,{children:"The built-in Rspack config in Rsbuild may change with iterations, and these changes won't be reflected in semver. Therefore, your custom config may become invalid when you upgrade Rsbuild."})})]}),"\n",(0,r.jsxs)(n.h2,{id:"view-rspack-config",children:["View Rspack Config",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#view-rspack-config",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild provides the ",(0,r.jsx)(n.a,{href:"/guide/basic/cli#rsbuild-inspect",children:"rsbuild inspect"})," command to view the final Rspack config generated by Rsbuild."]}),"\n",(0,r.jsxs)(n.p,{children:["You can also view it through ",(0,r.jsx)(n.a,{href:"/guide/debug/debug-mode",children:"debug mode"}),"."]}),"\n",(0,r.jsxs)(n.h2,{id:"modify-config-object",children:["Modify Config Object",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#modify-config-object",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.a,{href:"/config/tools/rspack",children:"tools.rspack"})," option of Rsbuild to modify the Rspack config object."]}),"\n",(0,r.jsx)(n.p,{children:"For example, register Rspack plugins or webpack plugins:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    rspack: {\n      plugins: [SomeWebpackPlugin()],\n    },\n  },\n};\n"})}),"\n",(0,r.jsx)(n.p,{children:"Or modify the Rspack config with a function:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    rspack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Please refer to the ",(0,r.jsx)(n.a,{href:"/config/tools/rspack",children:"tools.rspack documentation"})," for detailed usage."]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"use-bundler-chain",children:["Use Bundler Chain",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#use-bundler-chain",children:"#"})]}),"\n","\n",(0,r.jsx)(o.Z,{}),"\n",(0,r.jsxs)(n.h3,{id:"toolsbundlerchain",children:["tools.bundlerChain",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#toolsbundlerchain",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild provides the ",(0,r.jsx)(n.a,{href:"/config/tools/bundler-chain",children:"tools.bundlerChain"})," config to modify the rspack-chain. Its value is a function that takes two arguments:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The first argument is an ",(0,r.jsx)(n.code,{children:"rspack-chain"})," instance, which you can use to modify the Rspack config."]}),"\n",(0,r.jsxs)(n.li,{children:["The second argument is an utils object, including ",(0,r.jsx)(n.code,{children:"env"}),", ",(0,r.jsx)(n.code,{children:"isProd"}),", ",(0,r.jsx)(n.code,{children:"CHAIN_ID"}),", etc."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Here's a basic example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"tools.bundlerChain"})," can also be an async function:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { env }) => {\n      const value = await fetchValue();\n      chain.devtool(value);\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"basics",children:["Basics",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#basics",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Before using the rspack-chain to modify the Rspack configuration, it is recommended to familiarize yourself with some basics."}),"\n",(0,r.jsxs)(n.h4,{id:"about-id",children:["About ID",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#about-id",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"In short, the rspack-chain requires users to set a unique ID for each rule, loader, plugin, and minimizer. With this ID, you can easily find the desired object from deeply nested objects."}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild exports all internally defined IDs through the ",(0,r.jsx)(n.code,{children:"CHAIN_ID"})," object, so you can quickly locate the loader or plugin you want to modify using these exported IDs, without the need for complex traversal in the Rspack configuration object."]}),"\n",(0,r.jsxs)(n.p,{children:["For example, you can remove the built-in HTML plugin using ",(0,r.jsx)(n.code,{children:"CHAIN_ID.PLUGIN.HTML"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { CHAIN_ID }) => {\n      //\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HTML);\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"id-types",children:["ID Types",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#id-types",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"CHAIN_ID"})," object contains various IDs, which correspond to the following configurations:"]}),"\n",(0,r.jsxs)(n.table,{children:["\n",(0,r.jsxs)(n.thead,{children:["\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.th,{children:"CHAIN_ID Field"}),"\n",(0,r.jsx)(n.th,{children:"Corresponding Configuration"}),"\n",(0,r.jsx)(n.th,{children:"Description"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.tbody,{children:["\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CHAIN_ID.PLUGIN"})}),"\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"plugins[i]"})}),"\n",(0,r.jsx)(n.td,{children:"Corresponds to a plugin in the Rspack configuration"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CHAIN_ID.RULE"})}),"\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"module.rules[i]"})}),"\n",(0,r.jsx)(n.td,{children:"Corresponds to a rule in the Rspack configuration"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CHAIN_ID.USE"})}),"\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"module.rules[i].loader"})}),"\n",(0,r.jsx)(n.td,{children:"Corresponds to a loader in the Rspack configuration"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CHAIN_ID.MINIMIZER"})}),"\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"optimization.minimizer"})}),"\n",(0,r.jsx)(n.td,{children:"Corresponds to a minimizer in the Rspack configuration"}),"\n"]}),"\n",(0,r.jsxs)(n.tr,{children:["\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CHAIN_ID.RESOLVE_PLUGIN"})}),"\n",(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"resolve.plugins[i]"})}),"\n",(0,r.jsx)(n.td,{children:"Corresponds to a resolve plugin in the Rspack configuration"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"examples",children:["Examples",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#examples",children:"#"})]}),"\n",(0,r.jsxs)(n.h4,{id:"configure-loader",children:["Configure loader",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-loader",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Here are examples of adding, modifying, and removing Rspack loaders."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Add a loader to handle ",(0,r.jsx)(n.code,{children:".md"})," files:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain) => {\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        // The package name or module path of the loader\n        .loader('md-loader');\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Modify options of the built-in SWC loader:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { CHAIN_ID }) => {\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.SWC)\n        .tap((options) => {\n          console.log(options);\n          return options;\n        });\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Remove the built-in SWC loader:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { CHAIN_ID }) => {\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.SWC);\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Insert a loader after the built-in SWC loader that executes earlier:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { CHAIN_ID }) => {\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use('my-loader')\n        .after(CHAIN_ID.USE.SWC)\n        // The package name or module path of the loader\n        .loader('my-loader')\n        .options({\n          // some options\n        });\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Note: Rspack loaders are executed in reverse order."}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Insert a loader before the built-in SWC loader that executes later:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { CHAIN_ID }) => {\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        // Loader ID, not actually meaningful, just for locating\n        .use('my-loader')\n        .before(CHAIN_ID.USE.SWC)\n        // The package name or module path of the loader\n        .loader('my-loader')\n        .options({\n          // some options\n        });\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Remove the built-in CSS handling rule:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { CHAIN_ID }) => {\n      chain.module.rules.delete(CHAIN_ID.RULE.CSS);\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"configure-plugin",children:["Configure Plugin",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-plugin",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Here are examples of adding, modifying, and deleting Rspack plugins."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { bundler, CHAIN_ID }) => {\n      // Add plugin\n      chain.plugin('custom-define').use(bundler.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // Modify plugin\n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap((options) => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // Delete plugin\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"modify-based-on-environment",children:["Modify based on environment",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#modify-based-on-environment",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.code,{children:"tools.bundlerChain"})," function, you can access various environment identifiers in the second parameter, such as development/production build, SSR build, Web Worker build, to achieve configuration modifications for different environments."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="rsbuild.config.mjs"',children:"export default {\n  tools: {\n    bundlerChain: (chain, { env, isProd, target, isServer, isWebWorker }) => {\n      if (env === 'development' || env === 'test') {\n        // ...\n      }\n      if (isProd) {\n        // ...\n      }\n      if (target === 'node') {\n        // ...\n      }\n      if (isServer) {\n        // ...\n      }\n      if (isWebWorker) {\n        // ...\n      }\n    },\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The above are some common configuration examples. For the complete rspack-chain API, please refer to the ",(0,r.jsx)(n.a,{href:"https://github.com/rspack-contrib/rspack-chain",target:"_blank",rel:"noopener noreferrer",children:"rspack-chain documentation"}),"."]}),"\n",(0,r.jsxs)(n.h2,{id:"configuration-modification-order",children:["Configuration modification order",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration-modification-order",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild supports modifying the Rspack configuration object through ",(0,r.jsx)(n.code,{children:"tools.rspack"}),", ",(0,r.jsx)(n.code,{children:"tools.bundlerChain"}),", ",(0,r.jsx)(n.code,{children:"modifyBundlerChain"}),", etc."]}),"\n",(0,r.jsx)(n.p,{children:"The order of execution between them is:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/plugins/dev/hooks#modifybundlerchain",children:"modifyBundlerChain"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/config/tools/bundler-chain",children:"tools.bundleChain"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/plugins/dev/hooks#modifyrspackconfig",children:"modifyRspackConfig"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/config/tools/rspack",children:"tools.rspack"})}),"\n"]})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}let c=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["en%2Fguide%2Fbasic%2Fconfigure-rspack.mdx"]={toc:[{text:"View Rspack Config",id:"view-rspack-config",depth:2},{text:"Modify Config Object",id:"modify-config-object",depth:2},{text:"Use Bundler Chain",id:"use-bundler-chain",depth:2},{text:"tools.bundlerChain",id:"toolsbundlerchain",depth:3},{text:"Basics",id:"basics",depth:3},{text:"About ID",id:"about-id",depth:4},{text:"ID Types",id:"id-types",depth:4},{text:"Examples",id:"examples",depth:3},{text:"Configure loader",id:"configure-loader",depth:4},{text:"Configure Plugin",id:"configure-plugin",depth:4},{text:"Modify based on environment",id:"modify-based-on-environment",depth:4},{text:"Configuration modification order",id:"configuration-modification-order",depth:2}],title:"Configure Rspack",frontmatter:{}}},80493:function(e,n,i){i.d(n,{Z:function(){return a}});var r=i(55367),s=i(26971);function o(e){let n=Object.assign({p:"p",a:"a",code:"code"},(0,s.ah)(),e.components);return(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/rspack-contrib/rspack-chain",target:"_blank",rel:"noopener noreferrer",children:"rspack-chain"})," is a utility library for configuring Rspack. It provides a chaining API, making the configuration of Rspack more flexible. By using ",(0,r.jsx)(n.code,{children:"rspack-chain"}),", you can more easily modify and extend Rspack configurations without directly manipulating the complex configuration object."]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}let a=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["en%2Fshared%2FrspackChain.mdx"]={toc:[],title:"",frontmatter:{}}}}]);