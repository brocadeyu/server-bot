"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["8549"],{78505:function(e,r,n){n.r(r),n.d(r,{default:function(){return a}});var s=n(55367),l=n(26971),i=n(38146);function d(e){let r=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",pre:"pre",code:"code",blockquote:"blockquote",h3:"h3",div:"div",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,l.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.h1,{id:"webpack",children:["Webpack",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#webpack",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"本章节介绍如何将使用 webpack 的项目迁移到 Rsbuild。"}),"\n",(0,s.jsxs)(r.h2,{id:"安装依赖",children:["安装依赖",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#安装依赖",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"首先你需要把 webpack 相关的 npm 依赖替换为 Rsbuild 的依赖。"}),"\n","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"移除 webpack 的依赖："}),"\n"]}),"\n",(0,s.jsx)(i.PackageManagerTabs,{command:"remove webpack webpack-cli webpack-dev-server"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"安装 Rsbuild 的依赖："}),"\n"]}),"\n",(0,s.jsx)(i.PackageManagerTabs,{command:"add @rsbuild/core -D"}),"\n",(0,s.jsxs)(r.h2,{id:"更新-npm-scripts",children:["更新 npm scripts",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#更新-npm-scripts",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"下一步，你需要把 package.json 中的 npm scripts 更新为 Rsbuild 的 CLI 命令。"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-diff",meta:'title="package.json"',children:'{\n  "scripts": {\n-   "serve": "webpack serve -c webpack.config.js",\n-   "build": "webpack build -c webpack.config.js",\n+   "dev": "rsbuild dev",\n+   "build": "rsbuild build"\n  }\n}\n'})}),"\n",(0,s.jsxs)(r.h2,{id:"创建配置文件",children:["创建配置文件",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#创建配置文件",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["在 package.json 的同级目录下创建 Rsbuild 的配置文件 ",(0,s.jsx)(r.code,{children:"rsbuild.config.ts"}),"，并添加以下内容："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"import { defineConfig } from '@rsbuild/core';\n\nexport default defineConfig({\n  plugins: [],\n});\n"})}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsxs)(r.p,{children:["查看 ",(0,s.jsx)(r.a,{href:"/guide/basic/configure-rsbuild",children:"配置 Rsbuild"})," 了解更多。"]}),"\n"]}),"\n",(0,s.jsxs)(r.h2,{id:"配置迁移",children:["配置迁移",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#配置迁移",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["在一个 webpack 项目中，可能已经包含了一些复杂的 ",(0,s.jsx)(r.code,{children:"webpack.config.js"})," 配置文件。"]}),"\n",(0,s.jsx)(r.p,{children:"而迁移到 Rsbuild 后，大部分 webpack 配置已经被 Rsbuild 内置，不再需要手动配置，比如 output、resolve、module.rules 等。"}),"\n",(0,s.jsx)(r.p,{children:"对于少部分需要迁移的 webpack 配置，你可以选择以下方案："}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["使用 ",(0,s.jsx)(r.a,{href:"/config/tools/rspack",children:"tools.rspack"})," 选项（Rspack 和 webpack 的配置基本上等价）。"]}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  tools: {\n    rspack: {\n      plugins: [new SomeWebpackPlugin()],\n    },\n  },\n};\n"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["使用 Rsbuild 封装的配置项，比如 css-loader 的选项可以通过 ",(0,s.jsx)(r.a,{href:"/config/tools/css-loader",children:"tools.cssLoader"})," 设置。"]}),"\n"]}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsxs)(r.p,{children:["参考 ",(0,s.jsx)(r.a,{href:"/guide/basic/configure-rspack",children:"配置 Rspack"})," 了解更多。"]}),"\n"]}),"\n",(0,s.jsxs)(r.h3,{id:"构建入口",children:["构建入口",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#构建入口",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["webpack 使用 ",(0,s.jsx)(r.code,{children:"entry"})," 字段来设置构建入口，在 Rsbuild 中你可以使用 ",(0,s.jsx)(r.a,{href:"/config/source/entry",children:"source.entry"})," 来设置。"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  source: {\n    entry: {\n      foo: './src/pages/foo/index.ts',\n      bar: './src/pages/bar/index.ts',\n    },\n  },\n};\n"})}),"\n",(0,s.jsxs)(r.h3,{id:"清理配置",children:["清理配置",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#清理配置",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"由于 Rsbuild 内置了一些常见的 loader 和 plugin，所以你可以移除以下依赖和相关的配置，这会显著提升项目的依赖安装速度。"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"css-loader"}),"\n",(0,s.jsx)(r.li,{children:"babel-loader"}),"\n",(0,s.jsx)(r.li,{children:"style-loader"}),"\n",(0,s.jsx)(r.li,{children:"postcss-loader"}),"\n",(0,s.jsx)(r.li,{children:"html-webpack-plugin"}),"\n",(0,s.jsx)(r.li,{children:"mini-css-extract-plugin"}),"\n",(0,s.jsx)(r.li,{children:"autoprefixer"}),"\n",(0,s.jsx)(r.li,{children:"@babel/core"}),"\n",(0,s.jsx)(r.li,{children:"@babel/preset-env"}),"\n",(0,s.jsx)(r.li,{children:"@babel/preset-typescript"}),"\n",(0,s.jsx)(r.li,{children:"@babel/runtime"}),"\n",(0,s.jsx)(r.li,{children:"..."}),"\n"]}),"\n",(0,s.jsxs)(r.div,{className:"rspress-directive tip",children:[(0,s.jsx)(r.div,{className:"rspress-directive-title",children:"TIP"}),(0,s.jsx)(r.div,{className:"rspress-directive-content",children:(0,s.jsx)(r.p,{children:"以上仅列出了一些可以被移除的常见依赖。在一个真实的 webpack 项目中，可能还存在很多其他依赖，请酌情处理。"})})]}),"\n",(0,s.jsxs)(r.h3,{id:"使用插件",children:["使用插件",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#使用插件",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["Rsbuild 提供了丰富的插件，对常见的使用场景提供开箱即用的支持，你可以参考",(0,s.jsx)(r.a,{href:"/plugins/list/index",children:"插件列表"}),"文档来了解这些插件。"]}),"\n",(0,s.jsx)(r.p,{children:"我们以 React 项目为例，来介绍如何接入 Rsbuild 插件。首先，你可以移除一些 React 相关的构建依赖，它们已经被 Rsbuild React 插件内置，比如："}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"react-refresh"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"@babel/preset-react"})}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.code,{children:"@pmmmwh/react-refresh-webpack-plugin"})}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["然后参考 ",(0,s.jsx)(r.a,{href:"/plugins/list/plugin-react",children:"React 插件"})," 文档，注册并使用即可："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-diff",children:"import { defineConfig } from '@rsbuild/core';\n+import { pluginReact } from '@rsbuild/plugin-react';\n\nexport default {\n+  plugins: [pluginReact()],\n};\n"})}),"\n",(0,s.jsx)(r.p,{children:"大部分常见的 webpack loaders 和 plugins 都能在 Rsbuild 中继续使用，但我们推荐你优先使用 Rsbuild 提供的插件，这能够进一步简化你的配置。下面是它们的映射关系："}),"\n",(0,s.jsxs)(r.table,{children:["\n",(0,s.jsxs)(r.thead,{children:["\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.th,{children:"webpack"}),"\n",(0,s.jsx)(r.th,{children:"Rsbuild"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.tbody,{children:["\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/@babel/preset-react",target:"_blank",rel:"noopener noreferrer",children:"@babel/preset-react"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-react",children:"React 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/vue-loader",target:"_blank",rel:"noopener noreferrer",children:"vue-loader"})}),"\n",(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.a,{href:"/plugins/list/plugin-vue",children:"Vue 插件"})," 或 ",(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-vue2",target:"_blank",rel:"noopener noreferrer",children:"Vue 2 插件"})]}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/svelte-loader",target:"_blank",rel:"noopener noreferrer",children:"svelte-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-svelte",children:"Svelte 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/babel-preset-solid",target:"_blank",rel:"noopener noreferrer",children:"babel-preset-solid"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-solid",children:"Solid 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/babel-loader",target:"_blank",rel:"noopener noreferrer",children:"babel-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-babel",children:"Babel 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/sass-loader",target:"_blank",rel:"noopener noreferrer",children:"sass-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-sass",children:"Sass 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/less-loader",target:"_blank",rel:"noopener noreferrer",children:"less-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-less",children:"Less 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/stylus-loader",target:"_blank",rel:"noopener noreferrer",children:"stylus-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-stylus",children:"Stylus 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/mdx-loader",target:"_blank",rel:"noopener noreferrer",children:"mdx-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-mdx",target:"_blank",rel:"noopener noreferrer",children:"MDX 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/pug-loader",target:"_blank",rel:"noopener noreferrer",children:"pug-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-pug",target:"_blank",rel:"noopener noreferrer",children:"Pug 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/yaml-loader",target:"_blank",rel:"noopener noreferrer",children:"yaml-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-yaml",target:"_blank",rel:"noopener noreferrer",children:"Yaml 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/toml-loader",target:"_blank",rel:"noopener noreferrer",children:"toml-loader"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-toml",target:"_blank",rel:"noopener noreferrer",children:"Toml 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/@svgr/webpack",target:"_blank",rel:"noopener noreferrer",children:"@svgr/webpack"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"/plugins/list/plugin-svgr",children:"SVGR 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/fork-ts-checker-webpack-plugin",target:"_blank",rel:"noopener noreferrer",children:"fork-ts-checker-webpack-plugin"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-type-check",target:"_blank",rel:"noopener noreferrer",children:"@rsbuild/plugin-type-check"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/node-polyfill-webpack-plugin",target:"_blank",rel:"noopener noreferrer",children:"node-polyfill-webpack-plugin"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-node-polyfill",target:"_blank",rel:"noopener noreferrer",children:"Node Polyfill 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/@vue/babel-plugin-jsx",target:"_blank",rel:"noopener noreferrer",children:"@vue/babel-plugin-jsx"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-vue-jsx",target:"_blank",rel:"noopener noreferrer",children:"Vue JSX 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/@vue/babel-preset-jsx",target:"_blank",rel:"noopener noreferrer",children:"@vue/babel-preset-jsx"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-vue2-jsx",target:"_blank",rel:"noopener noreferrer",children:"Vue 2 JSX 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/eslint-webpack-plugin",target:"_blank",rel:"noopener noreferrer",children:"eslint-webpack-plugin"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-eslint",target:"_blank",rel:"noopener noreferrer",children:"ESLint 插件"})}),"\n"]}),"\n",(0,s.jsxs)(r.tr,{children:["\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/babel-plugin-styled-components",target:"_blank",rel:"noopener noreferrer",children:"babel-plugin-styled-components"})}),"\n",(0,s.jsx)(r.td,{children:(0,s.jsx)(r.a,{href:"https://github.com/rspack-contrib/rsbuild-plugin-styled-components",target:"_blank",rel:"noopener noreferrer",children:"Styled Components 插件"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.h3,{id:"配置-dev-server",children:["配置 Dev Server",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#配置-dev-server",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["Rsbuild 不支持使用 Rspack 的 ",(0,s.jsx)(r.a,{href:"https://rspack.dev/config/dev-server",target:"_blank",rel:"noopener noreferrer",children:"devServer"})," 配置项，请参考 ",(0,s.jsx)(r.a,{href:"/guide/basic/server#rspack-dev-server",children:"Rspack Dev Server"})," 进行替换。"]}),"\n",(0,s.jsxs)(r.h2,{id:"验证结果",children:["验证结果",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#验证结果",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["完成以上步骤后，你已经完成了从 webpack 到 Rsbuild 的基本迁移，此时可以执行 ",(0,s.jsx)(r.code,{children:"npm run dev"})," 命令来尝试启动开发服务器。"]}),"\n",(0,s.jsx)(r.p,{children:"如果在构建过程中发现问题，请根据错误日志进行调试，或者查看 webpack 配置，检查是否有一些必须的配置未被迁移到 Rsbuild。"}),"\n",(0,s.jsxs)(r.h2,{id:"内容补充",children:["内容补充",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#内容补充",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"当前文档只涵盖了迁移过程的部分事项，如果你发现有合适的内容可以补充，欢迎通过 pull request 来完善文档 \uD83E\uDD1D。"}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsxs)(r.p,{children:["Rsbuild 的文档位于 ",(0,s.jsx)(r.a,{href:"https://github.com/web-infra-dev/rsbuild/tree/main/website",target:"_blank",rel:"noopener noreferrer",children:"rsbuild/website"})," 目录。"]}),"\n"]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:r}=Object.assign({},(0,l.ah)(),e.components);return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}let a=c;c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["zh%2Fguide%2Fmigration%2Fwebpack.mdx"]={toc:[{text:"安装依赖",id:"安装依赖",depth:2},{text:"更新 npm scripts",id:"更新-npm-scripts",depth:2},{text:"创建配置文件",id:"创建配置文件",depth:2},{text:"配置迁移",id:"配置迁移",depth:2},{text:"构建入口",id:"构建入口",depth:3},{text:"清理配置",id:"清理配置",depth:3},{text:"使用插件",id:"使用插件",depth:3},{text:"配置 Dev Server",id:"配置-dev-server",depth:3},{text:"验证结果",id:"验证结果",depth:2},{text:"内容补充",id:"内容补充",depth:2}],title:"Webpack",frontmatter:{}}}}]);