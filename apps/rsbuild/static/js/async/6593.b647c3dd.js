"use strict";(self.webpackChunkrsbuild_website=self.webpackChunkrsbuild_website||[]).push([["6593"],{85577:function(e,n,s){s.r(n),s.d(n,{default:function(){return d}});var r=s(55367),i=s(26971);function l(e){let n=Object.assign({h1:"h1",a:"a",blockquote:"blockquote",p:"p",img:"img",h3:"h3",ul:"ul",li:"li",strong:"strong",pre:"pre",code:"code",h2:"h2"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"rsbuild-04-发布",children:["Rsbuild 0.4 发布",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#rsbuild-04-发布",children:"#"})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"February 06, 2024"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://assets.rspack.dev/rsbuild/rsbuild-banner-v0-4.png",alt:""})}),"\n",(0,r.jsx)(n.p,{children:"Rsbuild 0.4 版本提供内置的模块联邦支持。此外，还包含一些 API 的不兼容更新，请参考当前文档进行升级。"}),"\n",(0,r.jsxs)(n.h3,{id:"模块联邦配置",children:["模块联邦配置",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模块联邦配置",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 现在提供一个内置的 ",(0,r.jsx)(n.a,{href:"/config/module-federation/options",children:"moduleFederation"})," 选项，这将使得在 Rsbuild 中配置模块联邦变得更加容易。"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"示例："})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default defineConfig({\n  moduleFederation: {\n    options: {\n      // ModuleFederationPluginOptions\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["当你使用该选项时，Rsbuild 会自动修改默认的 ",(0,r.jsx)(n.code,{children:"publicPath"})," 和 ",(0,r.jsx)(n.code,{children:"splitChunks"})," 配置，使模块联邦可以开箱即用。"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["详见 ",(0,r.jsx)(n.a,{href:"https://github.com/web-infra-dev/rsbuild/discussions/1461",target:"_blank",rel:"noopener noreferrer",children:"RFC - Provide first-class support for Module Federation"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"插件-hook-顺序",children:["插件 Hook 顺序",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#插件-hook-顺序",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["在 Rsbuild 插件中使用 hook 时，现在可以通过 ",(0,r.jsx)(n.code,{children:"order"})," 字段来声明 hook 的顺序："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const myPlugin = () => ({\n  setup: (api) => {\n    api.modifyRsbuildConfig({\n      handler: () => console.log('hello'),\n      order: 'pre',\n    });\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["详见 ",(0,r.jsx)(n.a,{href:"/plugins/dev/hooks",children:"Plugin Hooks"}),"。"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"重命名-disablefilenamehash",children:["重命名 disableFilenameHash",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#重命名-disablefilenamehash",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"output.disableFilenameHash"})," 配置已被重命名为 ",(0,r.jsx)(n.a,{href:"/config/output/filename-hash",children:"output.filenameHash"}),"。"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"更改前："}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  output: {\n    disableFilenameHash: true,\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"更改后："}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default {\n  output: {\n    filenameHash: false,\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"移除-postcss-flexbugs-fixes",children:["移除 postcss-flexbugs-fixes",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#移除-postcss-flexbugs-fixes",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Rsbuild 0.4 移除了内置的 ",(0,r.jsx)(n.a,{href:"https://github.com/luisrudge/postcss-flexbugs-fixes",target:"_blank",rel:"noopener noreferrer",children:"postcss-flexbugs-fixes"})," 插件。"]}),"\n",(0,r.jsx)(n.p,{children:"该插件用于修复 IE 10 / 11 中的一些 flex bug。考虑到现代浏览器已经不再存在这些 flex 问题，我们移除了这个插件以提高构建性能。"}),"\n",(0,r.jsx)(n.p,{children:"如果你的项目需要兼容 IE 10 / 11 ，并且遇到了这些 flex 问题，你可以在 Rsbuild 中手动添加这个插件："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"安装插件："}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm add postcss-flexbugs-fixes -D\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["在 ",(0,r.jsx)(n.code,{children:"postcss.config.cjs"})," 中注册插件："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"module.exports = {\n  'postcss-flexbugs-fixes': {},\n};\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"pure-react-插件",children:["Pure React 插件",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#pure-react-插件",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["React 插件已移除对 ",(0,r.jsx)(n.a,{href:"https://www.npmjs.com/package/antd",target:"_blank",rel:"noopener noreferrer",children:"antd"})," v4 和 ",(0,r.jsx)(n.a,{href:"https://www.npmjs.com/package/@arco-design/web-react",target:"_blank",rel:"noopener noreferrer",children:"@arco-design/web-react"})," 的默认 ",(0,r.jsx)(n.a,{href:"/config/source/transform-import",children:"source.transformImport"})," 配置。"]}),"\n",(0,r.jsxs)(n.p,{children:["与组件库相关的配置应该在组件库相关的插件中提供，如 ",(0,r.jsx)(n.code,{children:"rsbuild-plugin-antd"})," 或 ",(0,r.jsx)(n.code,{children:"rsbuild-plugin-arco"}),"，而 React 插件会专注于提供 React 基础的能力。"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["如果你的项目正在使用 ",(0,r.jsx)(n.code,{children:"antd"})," v3 或 v4，你可以手动添加以下配置："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  source: {\n    transformImport: [\n      {\n        libraryName: 'antd',\n        libraryDirectory: 'es',\n        style: 'css',\n      },\n    ],\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["如果你的项目正在使用 ",(0,r.jsx)(n.code,{children:"@arco-design/web-react"})," v3 或 v4，你可以手动添加以下配置："]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",meta:'title="rsbuild.config.ts"',children:"export default {\n  source: {\n    transformImport: [\n      {\n        libraryName: '@arco-design/web-react',\n        libraryDirectory: 'es',\n        camelToDashComponentName: false,\n        style: 'css',\n      },\n      {\n        libraryName: '@arco-design/web-react/icon',\n        libraryDirectory: 'react-icon',\n        camelToDashComponentName: false,\n      },\n    ],\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"javascript-api",children:["JavaScript API",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#javascript-api",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"loadConfig"})," 方法现在会返回配置内容和配置文件的路径："]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"import { loadConfig } from '@rsbuild/core';\n\n// 0.3\nconst config = await loadConfig();\n\n// 0.4\nconst { content, filePath } = await loadConfig();\n"})})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}let d=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["zh%2Fcommunity%2Freleases%2Fv0-4.mdx"]={toc:[{text:"模块联邦配置",id:"模块联邦配置",depth:3},{text:"插件 Hook 顺序",id:"插件-hook-顺序",depth:3},{text:"重命名 disableFilenameHash",id:"重命名-disablefilenamehash",depth:3},{text:"移除 postcss-flexbugs-fixes",id:"移除-postcss-flexbugs-fixes",depth:2},{text:"Pure React 插件",id:"pure-react-插件",depth:2},{text:"JavaScript API",id:"javascript-api",depth:2}],title:"Rsbuild 0.4 发布",frontmatter:{published_at:"2024-02-06T08:00:00.000Z"}}}}]);