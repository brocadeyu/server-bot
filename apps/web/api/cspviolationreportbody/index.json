{"doc":{"isMarkdown":true,"isTranslated":false,"isActive":true,"flaws":{},"title":"CSPViolationReportBody","mdn_url":"/en-US/docs/Web/API/CSPViolationReportBody","locale":"en-US","native":"English (US)","browserCompat":["api.CSPViolationReportBody"],"sidebarHTML":"<ol><li class=\"section\"><a href=\"/en-US/docs/Web/API/Reporting_API\">Reporting API</a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li class=\"section\"><em><a href=\"/en-US/docs/Web/API/CSPViolationReportBody\" aria-current=\"page\"><code>CSPViolationReportBody</code></a></em></li><li class=\"toggle\"><details open=\"\"><summary>Instance properties</summary><ol><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/blockedURL\"><code>blockedURL</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/columnNumber\"><code>columnNumber</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/disposition\"><code>disposition</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/documentURL\"><code>documentURL</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/effectiveDirective\"><code>effectiveDirective</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/lineNumber\"><code>lineNumber</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/originalPolicy\"><code>originalPolicy</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/referrer\"><code>referrer</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/sample\"><code>sample</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/sourceFile\"><code>sourceFile</code></a></li><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/statusCode\"><code>statusCode</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Instance methods</summary><ol><li><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/toJSON\"><code>toJSON()</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Inheritance</summary><ol><li><a href=\"/en-US/docs/Web/API/ReportBody\"><code>ReportBody</code></a></li></ol></details></li><li class=\"toggle\"><details open=\"\"><summary>Related pages for Reporting API</summary><ol><li><a href=\"/en-US/docs/Web/API/DeprecationReportBody\"><code>DeprecationReportBody</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/InterventionReportBody\"><code>InterventionReportBody</code></a><abbr class=\"icon icon-experimental\" title=\"Experimental. Expect behavior to change in the future.\">\n    <span class=\"visually-hidden\">Experimental</span>\n</abbr></li><li><a href=\"/en-US/docs/Web/API/Report\"><code>Report</code></a></li><li><a href=\"/en-US/docs/Web/API/ReportBody\"><code>ReportBody</code></a></li><li><a href=\"/en-US/docs/Web/API/ReportingObserver\"><code>ReportingObserver</code></a></li><li><a href=\"/en-US/docs/Web/API/SecurityPolicyViolationEvent\"><code>SecurityPolicyViolationEvent</code></a></li></ol></details></li></ol>","sidebarMacro":"APIRef","body":[{"type":"prose","value":{"id":null,"title":null,"isH3":false,"content":"<div class=\"notecard secure\"><p><strong>Secure context:</strong> This feature is available only in <a href=\"/en-US/docs/Web/Security/Secure_Contexts\">secure contexts</a> (HTTPS), in some or all <a href=\"#browser_compatibility\">supporting browsers</a>.</p></div>\n<p>The <code>CSPViolationReportBody</code> interface is an extension of the <a href=\"/en-US/docs/Web/API/Reporting_API\">Reporting API</a> that represents the body of a Content Security Policy (CSP) violation report.</p>\n<p>CSP violations are thrown when the webpage attempts to load a resource that violates the policy set by the <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\"><code>Content-Security-Policy</code></a> HTTP header.</p>\n<p>\n  CSP violation reports are returned in the <a href=\"/en-US/docs/Web/API/ReportingObserver/ReportingObserver#reports\">reports</a> parameter of <a href=\"/en-US/docs/Web/API/ReportingObserver\"><code>ReportingObserver</code></a> callbacks that have a <code>type</code> of <code>\"csp-violation\"</code>.\n  The <code>body</code> property of those reports is an instance of <code>CSPViolationReportBody</code>.\n</p>\n<p>\n  CSP violation reports may also be sent as JSON objects to the endpoint specified in the <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to\"><code>report-to</code></a> policy directive of the <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\"><code>Content-Security-Policy</code></a> header.\n  These reports similarly have a <code>type</code> of <code>\"csp-violation\"</code>, and a <code>body</code> property containing a serialization of an instance of this interface.\n</p>\n<div class=\"notecard note\">\n  <p>\n    <strong>Note:</strong> CSP violation reports sent by the Reporting API, when an endpoint is specified using the CSP <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to\"><code>report-to</code></a> directive, are similar (but not identical) to the \"CSP report\" <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri#violation_report_syntax\">JSON objects</a> sent when endpoints are specified using the <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri\"><code>report-uri</code></a> directive.\n    The Reporting API and <code>report-to</code> directive are intended to replace the older report format and the <code>report-uri</code> directive.\n  </p>\n</div><svg viewBox=\"-1 -1 650 42\" preserveAspectRatio=\"xMinYMin meet\">\n  <a style=\"text-decoration: none;\" href=\"/en-US/docs/Web/API/ReportBody\">\n    <rect x=\"0\" y=\"0\" width=\"80\" height=\"25\" fill=\"#fff\" stroke=\"#D4DDE4\" stroke-width=\"2px\"></rect>\n    <text x=\"40\" y=\"16\" font-size=\"10px\" fill=\"#4D4E53\" text-anchor=\"middle\">\n      ReportBody\n    </text>\n  </a>\n  <line x1=\"80\" y1=\"14\" x2=\"110\" y2=\"14\" stroke=\"#D4DDE4\"></line>\n  <polyline points=\"80,14 90,9 90,19 80,14\" stroke=\"#D4DDE4\" fill=\"#fff\"></polyline>\n  <a style=\"text-decoration: none;\" href=\"/en-US/docs/Web/API/CSPViolationReportBody\" aria-current=\"page\">\n    <rect x=\"110\" y=\"0\" width=\"176\" height=\"25\" fill=\"#F4F7F8\" stroke=\"#D4DDE4\" stroke-width=\"2px\"></rect>\n    <text x=\"198\" y=\"16\" font-size=\"10px\" fill=\"#4D4E53\" text-anchor=\"middle\">\n      CSPViolationReportBody\n    </text>\n  </a></svg>"}},{"type":"prose","value":{"id":"instance_properties","title":"Instance properties","isH3":false,"content":"<p><em>Also inherits properties from its parent interface, <a href=\"/en-US/docs/Web/API/ReportBody\"><code>ReportBody</code></a>.</em></p>\n<dl>\n  <dt id=\"cspviolationreportbody.blockedurl\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/blockedURL\"><code>CSPViolationReportBody.blockedURL</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>A string representing either the type or the URL of the resource that was blocked because it violates the CSP.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.columnnumber\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/columnNumber\"><code>CSPViolationReportBody.columnNumber</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>The column number in the script at which the violation occurred.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.disposition\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/disposition\"><code>CSPViolationReportBody.disposition</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>Indicates how the violated policy is configured to be treated by the user agent. This will be <code>\"enforce\"</code> or <code>\"report\"</code>.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.documenturl\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/documentURL\"><code>CSPViolationReportBody.documentURL</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>A string representing the URL of the document or worker in which the violation was found.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.effectivedirective\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/effectiveDirective\"><code>CSPViolationReportBody.effectiveDirective</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>A string representing the directive whose enforcement uncovered the violation.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.linenumber\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/lineNumber\"><code>CSPViolationReportBody.lineNumber</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>The line number in the script at which the violation occurred.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.originalpolicy\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/originalPolicy\"><code>CSPViolationReportBody.originalPolicy</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>A string containing the policy whose enforcement uncovered the violation.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.referrer\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/referrer\"><code>CSPViolationReportBody.referrer</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>A string representing the URL for the referrer of the resources whose policy was violated, or <code>null</code>.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.sample\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/sample\"><code>CSPViolationReportBody.sample</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>A string representing a sample of the resource that caused the violation, usually the first 40 characters. This will only be populated if the resource is an inline script, event handler, or style â€” external resources causing a violation will not generate a sample.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.sourcefile\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/sourceFile\"><code>CSPViolationReportBody.sourceFile</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>If the violation occurred as a result of a script, this will be the URL of the script; otherwise, it will be <code>null</code>. Both <code>columnNumber</code> and <code>lineNumber</code> should have non-null values if this property is not <code>null</code>.</p>\n  </dd>\n  <dt id=\"cspviolationreportbody.statuscode\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/statusCode\"><code>CSPViolationReportBody.statusCode</code></a> <span class=\"badge inline readonly\" title=\"This value may not be changed.\">Read only </span></dt>\n  <dd>\n    <p>A number representing the HTTP status code of the document or worker in which the violation occurred.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"instance_methods","title":"Instance methods","isH3":false,"content":"<p><em>Also inherits methods from its parent interface, <a href=\"/en-US/docs/Web/API/ReportBody\"><code>ReportBody</code></a>.</em></p>\n<dl>\n  <dt id=\"cspviolationreportbody.tojson\"><a href=\"/en-US/docs/Web/API/CSPViolationReportBody/toJSON\"><code>CSPViolationReportBody.toJSON()</code></a></dt>\n  <dd>\n    <p>A <em>serializer</em> which returns a JSON representation of the <code>CSPViolationReportBody</code> object.</p>\n  </dd>\n</dl>"}},{"type":"prose","value":{"id":"examples","title":"Examples","isH3":false,"content":""}},{"type":"prose","value":{"id":"obtaining_a_cspviolationreportbody_object","title":"Obtaining a <code>CSPViolationReportBody</code> object","isH3":true,"content":"<p>\n  To obtain a <code>CSPViolationReportBody</code> object, you must configure your page so that a CSP violation will occur.\n  In this example, we will set our CSP to only allow content from the site's own origin, and then attempt to load a script from <code>apis.google.com</code>, which is an external origin.\n</p>\n<p>First, we will set our <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\"><code>Content-Security-Policy</code></a> header in the HTTP response:</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">http</span></div><pre class=\"brush: http notranslate\"><code>Content-Security-Policy: default-src 'self';\n</code></pre></div>\n<p>or in the HTML <a href=\"/en-US/docs/Web/HTML/Element/meta\"><code>&lt;meta&gt;</code></a> element:</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">html</span></div><pre class=\"brush: html notranslate\"><code>&lt;meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'\" /&gt;\n</code></pre></div>\n<p>Then, we will attempt to load an external script:</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">html</span></div><pre class=\"brush: html notranslate\"><code>&lt;!-- This should generate a CSP violation --&gt;\n&lt;script src=\"https://apis.google.com/js/platform.js\"&gt;&lt;/script&gt;\n</code></pre></div>\n<p>Finally, we will create a new <a href=\"/en-US/docs/Web/API/ReportingObserver\"><code>ReportingObserver</code></a> object to listen for CSP violations (this will need to be loaded from the same location, before the script that causes the violation).</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>const observer = new ReportingObserver(\n  (reports, observer) =&gt; {\n    reports.forEach((violation) =&gt; {\n      console.log(violation);\n      console.log(JSON.stringify(violation));\n    });\n  },\n  {\n    types: [\"csp-violation\"],\n    buffered: true,\n  },\n);\n\nobserver.observe();\n</code></pre></div>\n<p>\n  Above we log the each violation report object and a JSON-string version of the object, which might look similar to the object below.\n  Note that the <code>body</code> is an instance of the <code>CSPViolationReportBody</code> and the <code>type</code> is <code>\"csp-violation\"</code>.\n</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">js</span></div><pre class=\"brush: js notranslate\"><code>{\n    \"type\": \"csp-violation\",\n    \"url\": \"http://127.0.0.1:9999/\",\n    \"body\": {\n        \"sourceFile\": null,\n        \"lineNumber\": null,\n        \"columnNumber\": null,\n        \"documentURL\": \"http://127.0.0.1:9999/\",\n        \"referrer\": \"\",\n        \"blockedURL\": \"https://apis.google.com/js/platform.js\",\n        \"effectiveDirective\": \"script-src-elem\",\n        \"originalPolicy\": \"default-src 'self';\",\n        \"sample\": \"\",\n        \"disposition\": \"enforce\",\n        \"statusCode\": 200\n    }\n}\n</code></pre></div>"}},{"type":"prose","value":{"id":"sending_a_csp_violation_report","title":"Sending a CSP violation report","isH3":true,"content":"<p>\n  Configuring a web page to send a CSP violation report is similar to the previous example.\n  As before, you need to configure your page so that there is a violation.\n</p>\n<p>\n  In addition, you also need to specify the endpoint(s) where the report will be sent.\n  A server specifies endpoints using the <a href=\"/en-US/docs/Web/HTTP/Headers/Reporting-Endpoints\"><code>Reporting-Endpoints</code></a> response header: these must be secure URLs (HTTPS).\n  The CSP <a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to\"><code>report-to</code></a> directive is then used to specify that a particular endpoint is used for reporting CSP violations:\n</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">http</span></div><pre class=\"brush: http notranslate\"><code>Reporting-Endpoints: csp-endpoint=\"https://example.com/csp-report-to\"\nContent-Security-Policy: default-src 'self'; report-to csp-endpoint\n</code></pre></div>\n<p>As before, we can trigger a violation by loading an external script from a location that is not allowed by our CSP header:</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">html</span></div><pre class=\"brush: html notranslate\"><code>&lt;!-- This should generate a CSP violation --&gt;\n&lt;script src=\"https://apis.google.com/js/platform.js\"&gt;&lt;/script&gt;\n</code></pre></div>\n<p>\n  The violation report will then be sent to the indicated endpoint as a JSON file.\n  As you can see from the example below, the <code>type</code> is <code>\"csp-violation\"</code> and the <code>body</code> property is a serialization of the <code>CSPViolationReportBody</code> object:\n</p>\n<div class=\"code-example\"><div class=\"example-header\"><span class=\"language-name\">json</span></div><pre class=\"brush: json notranslate\"><code>[\n  {\n    \"age\": 53531,\n    \"body\": {\n      \"blockedURL\": \"inline\",\n      \"columnNumber\": 59,\n      \"disposition\": \"enforce\",\n      \"documentURL\": \"https://example.com/csp-report-to\",\n      \"effectiveDirective\": \"script-src-elem\",\n      \"lineNumber\": 1441,\n      \"originalPolicy\": \"default-src 'self'; report-to csp-endpoint\",\n      \"referrer\": \"https://www.google.com/\",\n      \"sample\": \"\",\n      \"sourceFile\": \"https://example.com/csp-report-to\",\n      \"statusCode\": 200\n    },\n    \"type\": \"csp-violation\",\n    \"url\": \"https://example.com/csp-report-to\",\n    \"user_agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36\"\n  }\n]\n</code></pre></div>"}},{"type":"specifications","value":{"title":"Specifications","id":"specifications","isH3":false,"specifications":[{"bcdSpecificationURL":"https://w3c.github.io/webappsec-csp/#cspviolationreportbody","title":"Content Security Policy Level 3"}],"query":"api.CSPViolationReportBody"}},{"type":"browser_compatibility","value":{"title":"Browser compatibility","id":"browser_compatibility","isH3":false,"query":"api.CSPViolationReportBody"}},{"type":"prose","value":{"id":"see_also","title":"See also","isH3":false,"content":"<ul>\n  <li><a href=\"/en-US/docs/Web/API/ReportBody\"><code>ReportBody</code></a></li>\n  <li><a href=\"/en-US/docs/Web/API/ReportingObserver\"><code>ReportingObserver</code></a></li>\n  <li><a href=\"/en-US/docs/Web/HTTP/Headers/Content-Security-Policy\"><code>Content-Security-Policy</code></a></li>\n  <li><a href=\"/en-US/docs/Web/API/SecurityPolicyViolationEvent\"><code>SecurityPolicyViolationEvent</code></a></li>\n</ul>"}}],"toc":[{"text":"Instance properties","id":"instance_properties"},{"text":"Instance methods","id":"instance_methods"},{"text":"Examples","id":"examples"},{"text":"Specifications","id":"specifications"},{"text":"Browser compatibility","id":"browser_compatibility"},{"text":"See also","id":"see_also"}],"summary":"The CSPViolationReportBody interface is an extension of the Reporting API that represents the body of a Content Security Policy (CSP) violation report.","popularity":0.0014,"modified":null,"other_translations":[],"pageType":"web-api-interface","source":{"folder":"en-us/web/api/cspviolationreportbody","github_url":"https://github.com/mdn/content/blob/main/files/en-us/web/api/cspviolationreportbody/index.md","last_commit_url":"https://github.com/mdn/content/commit/null","filename":"index.md"},"short_title":"CSPViolationReportBody","parents":[{"uri":"/en-US/docs/Web","title":"References"},{"uri":"/en-US/docs/Web/API","title":"Web APIs"},{"uri":"/en-US/docs/Web/API/CSPViolationReportBody","title":"CSPViolationReportBody"}],"pageTitle":"CSPViolationReportBody - Web APIs | MDN","noIndexing":false},"url":"/en-US/docs/Web/API/CSPViolationReportBody"}