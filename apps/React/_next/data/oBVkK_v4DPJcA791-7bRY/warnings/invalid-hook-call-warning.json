{"pageProps":{"toc":"[{\"url\":\"#\",\"text\":\"Overview\",\"depth\":2},{\"url\":\"#breaking-rules-of-hooks\",\"depth\":2,\"text\":\"Breaking Rules of Hooks \"},{\"url\":\"#mismatching-versions-of-react-and-react-dom\",\"depth\":2,\"text\":\"Mismatching Versions of React and React DOM \"},{\"url\":\"#duplicate-react\",\"depth\":2,\"text\":\"Duplicate React \"},{\"url\":\"#other-causes\",\"depth\":2,\"text\":\"Other Causes \"}]","content":"[[\"$r\",\"MaxWidth\",\"last\",{\"children\":[[\"$r\",\"p\",null,{\"children\":\"You are probably here because you got the following error message:\"}],\"\\n\",[\"$r\",\"ConsoleBlock\",null,{\"level\":\"error\",\"children\":[\"$r\",\"p\",null,{\"children\":\"Hooks can only be called inside the body of a function component.\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"There are three common reasons you might be seeing it:\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"You might be \",[\"$r\",\"strong\",null,{\"children\":\"breaking the Rules of Hooks\"}],\".\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"You might have \",[\"$r\",\"strong\",null,{\"children\":\"mismatching versions\"}],\" of React and React DOM.\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"You might have \",[\"$r\",\"strong\",null,{\"children\":\"more than one copy of React\"}],\" in the same app.\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Letâ€™s look at each of these cases.\"}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"breaking-rules-of-hooks\",\"children\":\"Breaking Rules of Hooks \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Functions whose names start with \",[\"$r\",\"code\",null,{\"children\":\"use\"}],\" are called \",[\"$r\",\"a\",null,{\"href\":\"/reference/react\",\"children\":[\"$r\",\"em\",null,{\"children\":\"Hooks\"}]}],\" in React.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"Donâ€™t call Hooks inside loops, conditions, or nested functions.\"}],\" Instead, always use Hooks at the top level of your React function, before any early returns. You can only call Hooks while React is rendering a function component:\"]}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"âœ… Call them at the top level in the body of a \",[\"$r\",\"a\",null,{\"href\":\"/learn/your-first-component\",\"children\":\"function component\"}],\".\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"âœ… Call them at the top level in the body of a \",[\"$r\",\"a\",null,{\"href\":\"/learn/reusing-logic-with-custom-hooks\",\"children\":\"custom Hook\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js{2-3,8-9}\",\"children\":\"function Counter() {\\n  // âœ… Good: top-level in a function component\\n  const [count, setCount] = useState(0);\\n  // ...\\n}\\n\\nfunction useWindowWidth() {\\n  // âœ… Good: top-level in a custom Hook\\n  const [width, setWidth] = useState(window.innerWidth);\\n  // ...\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Itâ€™s \",[\"$r\",\"strong\",null,{\"children\":\"not\"}],\" supported to call Hooks (functions starting with \",[\"$r\",\"code\",null,{\"children\":\"use\"}],\") in any other cases, for example:\"]}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ðŸ”´ Do not call Hooks inside conditions or loops.\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ðŸ”´ Do not call Hooks after a conditional \",[\"$r\",\"code\",null,{\"children\":\"return\"}],\" statement.\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ðŸ”´ Do not call Hooks in event handlers.\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ðŸ”´ Do not call Hooks in class components.\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ðŸ”´ Do not call Hooks inside functions passed to \",[\"$r\",\"code\",null,{\"children\":\"useMemo\"}],\", \",[\"$r\",\"code\",null,{\"children\":\"useReducer\"}],\", or \",[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"If you break these rules, you might see this error.\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js{3-4,11-12,20-21}\",\"children\":\"function Bad({ cond }) {\\n  if (cond) {\\n    // ðŸ”´ Bad: inside a condition (to fix, move it outside!)\\n    const theme = useContext(ThemeContext);\\n  }\\n  // ...\\n}\\n\\nfunction Bad() {\\n  for (let i = 0; i < 10; i++) {\\n    // ðŸ”´ Bad: inside a loop (to fix, move it outside!)\\n    const theme = useContext(ThemeContext);\\n  }\\n  // ...\\n}\\n\\nfunction Bad({ cond }) {\\n  if (cond) {\\n    return;\\n  }\\n  // ðŸ”´ Bad: after a conditional return (to fix, move it before the return!)\\n  const theme = useContext(ThemeContext);\\n  // ...\\n}\\n\\nfunction Bad() {\\n  function handleClick() {\\n    // ðŸ”´ Bad: inside an event handler (to fix, move it outside!)\\n    const theme = useContext(ThemeContext);\\n  }\\n  // ...\\n}\\n\\nfunction Bad() {\\n  const style = useMemo(() => {\\n    // ðŸ”´ Bad: inside useMemo (to fix, move it outside!)\\n    const theme = useContext(ThemeContext);\\n    return createStyle(theme);\\n  });\\n  // ...\\n}\\n\\nclass Bad extends React.Component {\\n  render() {\\n    // ðŸ”´ Bad: inside a class component (to fix, write a function component instead of a class!)\\n    useEffect(() => {})\\n    // ...\\n  }\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"You can use the \",[\"$r\",\"a\",null,{\"href\":\"https://www.npmjs.com/package/eslint-plugin-react-hooks\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[[\"$r\",\"code\",null,{\"children\":\"eslint-plugin-react-hooks\"}],\" plugin\"]}],\" to catch these mistakes.\"]}],\"\\n\",[\"$r\",\"Note\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"a\",null,{\"href\":\"/learn/reusing-logic-with-custom-hooks\",\"children\":\"Custom Hooks\"}],\" \",[\"$r\",\"em\",null,{\"children\":\"may\"}],\" call other Hooks (thatâ€™s their whole purpose). This works because custom Hooks are also supposed to only be called while a function component is rendering.\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"mismatching-versions-of-react-and-react-dom\",\"children\":\"Mismatching Versions of React and React DOM \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"You might be using a version of \",[\"$r\",\"code\",null,{\"children\":\"react-dom\"}],\" (< 16.8.0) or \",[\"$r\",\"code\",null,{\"children\":\"react-native\"}],\" (< 0.59) that doesnâ€™t yet support Hooks. You can run \",[\"$r\",\"code\",null,{\"children\":\"npm ls react-dom\"}],\" or \",[\"$r\",\"code\",null,{\"children\":\"npm ls react-native\"}],\" in your application folder to check which version youâ€™re using. If you find more than one of them, this might also create problems (more on that below).\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"duplicate-react\",\"children\":\"Duplicate React \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"In order for Hooks to work, the \",[\"$r\",\"code\",null,{\"children\":\"react\"}],\" import from your application code needs to resolve to the same module as the \",[\"$r\",\"code\",null,{\"children\":\"react\"}],\" import from inside the \",[\"$r\",\"code\",null,{\"children\":\"react-dom\"}],\" package.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"If these \",[\"$r\",\"code\",null,{\"children\":\"react\"}],\" imports resolve to two different exports objects, you will see this warning. This may happen if you \",[\"$r\",\"strong\",null,{\"children\":\"accidentally end up with two copies\"}],\" of the \",[\"$r\",\"code\",null,{\"children\":\"react\"}],\" package.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"If you use Node for package management, you can run this check in your project folder:\"}],\"\\n\",[\"$r\",\"TerminalBlock\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"npm ls react\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"If you see more than one React, youâ€™ll need to figure out why this happens and fix your dependency tree. For example, maybe a library youâ€™re using incorrectly specifies \",[\"$r\",\"code\",null,{\"children\":\"react\"}],\" as a dependency (rather than a peer dependency). Until that library is fixed, \",[\"$r\",\"a\",null,{\"href\":\"https://yarnpkg.com/lang/en/docs/selective-version-resolutions/\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Yarn resolutions\"}],\" is one possible workaround.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"You can also try to debug this problem by adding some logs and restarting your development server:\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"// Add this in node_modules/react-dom/index.js\\nwindow.React1 = require('react');\\n\\n// Add this in your component file\\nrequire('react-dom');\\nwindow.React2 = require('react');\\nconsole.log(window.React1 === window.React2);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"If it prints \",[\"$r\",\"code\",null,{\"children\":\"false\"}],\" then you might have two Reacts and need to figure out why that happened. \",[\"$r\",\"a\",null,{\"href\":\"https://github.com/facebook/react/issues/13991\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"This issue\"}],\" includes some common reasons encountered by the community.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"This problem can also come up when you use \",[\"$r\",\"code\",null,{\"children\":\"npm link\"}],\" or an equivalent. In that case, your bundler might â€œseeâ€ two Reacts â€” one in application folder and one in your library folder. Assuming \",[\"$r\",\"code\",null,{\"children\":\"myapp\"}],\" and \",[\"$r\",\"code\",null,{\"children\":\"mylib\"}],\" are sibling folders, one possible fix is to run \",[\"$r\",\"code\",null,{\"children\":\"npm link ../myapp/node_modules/react\"}],\" from \",[\"$r\",\"code\",null,{\"children\":\"mylib\"}],\". This should make the library use the applicationâ€™s React copy.\"]}],\"\\n\",[\"$r\",\"Note\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"In general, React supports using multiple independent copies on one page (for example, if an app and a third-party widget both use it). It only breaks if \",[\"$r\",\"code\",null,{\"children\":\"require('react')\"}],\" resolves differently between the component and the \",[\"$r\",\"code\",null,{\"children\":\"react-dom\"}],\" copy it was rendered with.\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"other-causes\",\"children\":\"Other Causes \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"If none of this worked, please comment in \",[\"$r\",\"a\",null,{\"href\":\"https://github.com/facebook/react/issues/13991\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"this issue\"}],\" and weâ€™ll try to help. Try to create a small reproducing example â€” you might discover the problem as youâ€™re doing it.\"]}]]}]]","meta":{"title":"Rules of Hooks"},"languages":null},"__N_SSG":true}