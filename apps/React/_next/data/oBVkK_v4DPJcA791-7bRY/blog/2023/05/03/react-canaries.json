{"pageProps":{"toc":"[{\"url\":\"#\",\"text\":\"Overview\",\"depth\":2},{\"url\":\"#tldr\",\"depth\":2,\"text\":\"tl;dr \"},{\"url\":\"#how-react-features-are-usually-developed\",\"depth\":2,\"text\":\"How React features are usually developed \"},{\"url\":\"#can-we-just-do-more-minor-releases\",\"depth\":2,\"text\":\"Can we just do more minor releases? \"},{\"url\":\"#why-not-use-experimental-releases-instead\",\"depth\":2,\"text\":\"Why not use experimental releases instead? \"},{\"url\":\"#announcing-breaking-changes-and-new-features-early\",\"depth\":2,\"text\":\"Announcing breaking changes and new features early \"},{\"url\":\"#canaries-must-be-pinned\",\"depth\":2,\"text\":\"Canaries must be pinned \"},{\"url\":\"#example-react-server-components\",\"depth\":2,\"text\":\"Example: React Server Components \"},{\"url\":\"#testing-libraries-against-both-stable-and-canary-versions\",\"depth\":2,\"text\":\"Testing libraries against both Stable and Canary versions \"},{\"url\":\"#stable-releases-work-like-before\",\"depth\":2,\"text\":\"Stable releases work like before \"}]","content":"[[\"$r\",\"MaxWidth\",\"last\",{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"May 3, 2023 by \",[\"$r\",\"a\",null,{\"href\":\"https://twitter.com/dan_abramov\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Dan Abramov\"}],\", \",[\"$r\",\"a\",null,{\"href\":\"https://twitter.com/sophiebits\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Sophie Alpert\"}],\", \",[\"$r\",\"a\",null,{\"href\":\"https://twitter.com/rickhanlonii\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Rick Hanlon\"}],\", \",[\"$r\",\"a\",null,{\"href\":\"https://twitter.com/sebmarkbage\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Sebastian Markbåge\"}],\", and \",[\"$r\",\"a\",null,{\"href\":\"https://twitter.com/acdlite\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Andrew Clark\"}]]}],\"\\n\",[\"$r\",\"hr\",null,{}],\"\\n\",[\"$r\",\"Intro\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"We’d like to offer the React community an option to adopt individual new features as soon as their design is close to final, before they’re released in a stable version—similar to how Meta has long used bleeding-edge versions of React internally. We are introducing a new officially supported \",[\"$r\",\"a\",null,{\"href\":\"/community/versioning-policy#canary-channel\",\"children\":\"Canary release channel\"}],\". It lets curated setups like frameworks decouple adoption of individual React features from the React release schedule.\"]}]}],\"\\n\",[\"$r\",\"hr\",null,{}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"tldr\",\"children\":\"tl;dr \"}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"We’re introducing an officially supported \",[\"$r\",\"a\",null,{\"href\":\"/community/versioning-policy#canary-channel\",\"children\":\"Canary release channel\"}],\" for React. Since it’s officially supported, if any regressions land, we’ll treat them with a similar urgency to bugs in stable releases.\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"Canaries let you start using individual new React features before they land in the semver-stable releases.\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"Unlike the \",[\"$r\",\"a\",null,{\"href\":\"/community/versioning-policy#experimental-channel\",\"children\":\"Experimental\"}],\" channel, React Canaries only include features that we reasonably believe to be ready for adoption. We encourage frameworks to consider bundling pinned Canary React releases.\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"We will announce breaking changes and new features on our blog as they land in Canary releases.\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":\"As always, React continues to follow semver for every Stable release.\"}]}],\"\\n\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"how-react-features-are-usually-developed\",\"children\":\"How React features are usually developed \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Typically, every React feature has gone through the same stages:\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"We develop an initial version and prefix it with \",[\"$r\",\"code\",null,{\"children\":\"experimental_\"}],\" or \",[\"$r\",\"code\",null,{\"children\":\"unstable_\"}],\". The feature is only available in the \",[\"$r\",\"code\",null,{\"children\":\"experimental\"}],\" release channel. At this point, the feature is expected to change significantly.\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"We find a team at Meta willing to help us test this feature and provide feedback on it. This leads to a round of changes. As the feature becomes more stable, we work with more teams at Meta to try it out.\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"Eventually, we feel confident in the design. We remove the prefix from the API name, and make the feature available on the \",[\"$r\",\"code\",null,{\"children\":\"main\"}],\" branch by default, which most Meta products use. At this point, any team at Meta can use this feature.\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"As we build confidence in the direction, we also post an RFC for the new feature. At this point we know the design works for a broad set of cases, but we might make some last minute adjustments.\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"When we are close to cutting an open source release, we write documentation for the feature and finally release the feature in a stable React release.\"}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"This playbook works well for most features we’ve released so far. However, there can be a significant gap between when the feature is generally ready to use (step 3) and when it is released in open source (step 5).\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":\"We’d like to offer the React community an option to follow the same approach as Meta, and adopt individual new features earlier (as they become available) without having to wait for the next release cycle of React.\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"As always, all React features will eventually make it into a Stable release.\"}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"can-we-just-do-more-minor-releases\",\"children\":\"Can we just do more minor releases? \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Generally, we \",[\"$r\",\"em\",null,{\"children\":\"do\"}],\" use minor releases for introducing new features.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"However, this isn’t always possible. Sometimes, new features are interconnected with \",[\"$r\",\"em\",null,{\"children\":\"other\"}],\" new features which have not yet been fully completed and that we’re still actively iterating on. We can’t release them separately because their implementations are related. We can’t version them separately because they affect the same packages (for example, \",[\"$r\",\"code\",null,{\"children\":\"react\"}],\" and \",[\"$r\",\"code\",null,{\"children\":\"react-dom\"}],\"). And we need to keep the ability to iterate on the pieces that aren’t ready without a flurry of major version releases, which semver would require us to do.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"At Meta, we’ve solved this problem by building React from the \",[\"$r\",\"code\",null,{\"children\":\"main\"}],\" branch, and manually updating it to a specific pinned commit every week. This is also the approach that React Native releases have been following for the last several years. Every \",[\"$r\",\"em\",null,{\"children\":\"stable\"}],\" release of React Native is pinned to a specific commit from the \",[\"$r\",\"code\",null,{\"children\":\"main\"}],\" branch of the React repository. This lets React Native include important bugfixes and incrementally adopt new React features at the framework level without getting coupled to the global React release schedule.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"We would like to make this workflow available to other frameworks and curated setups. For example, it lets a framework \",[\"$r\",\"em\",null,{\"children\":\"on top of\"}],\" React include a React-related breaking change \",[\"$r\",\"em\",null,{\"children\":\"before\"}],\" this breaking change gets included into a stable React release. This is particularly useful because some breaking changes only affect framework integrations. This lets a framework release such a change in its own minor version without breaking semver.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Rolling releases with the Canaries channel will allow us to have a tighter feedback loop and ensure that new features get comprehensive testing in the community. This workflow is closer to how TC39, the JavaScript standards committee, \",[\"$r\",\"a\",null,{\"href\":\"https://tc39.es/process-document/\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"handles changes in numbered stages\"}],\". New React features may be available in frameworks built on React before they are in a React stable release, just as new JavaScript features ship in browsers before they are officially ratified as part of the specification.\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"why-not-use-experimental-releases-instead\",\"children\":\"Why not use experimental releases instead? \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Although you \",[\"$r\",\"em\",null,{\"children\":\"can\"}],\" technically use \",[\"$r\",\"a\",null,{\"href\":\"/community/versioning-policy#canary-channel\",\"children\":\"Experimental releases\"}],\", we recommend against using them in production because experimental APIs can undergo significant breaking changes on their way to stabilization (or can even be removed entirely). While Canaries can also contain mistakes (as with any release), going forward we plan to announce any significant breaking changes in Canaries on our blog. Canaries are the closest to the code Meta runs internally, so you can generally expect them to be relatively stable. However, you \",[\"$r\",\"em\",null,{\"children\":\"do\"}],\" need to keep the version pinned and manually scan the GitHub commit log when updating between the pinned commits.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"We expect that most people using React outside a curated setup (like a framework) will want to continue using the Stable releases.\"}],\" However, if you’re building a framework, you might want to consider bundling a Canary version of React pinned to a particular commit, and update it at your own pace. The benefit of that is that it lets you ship individual completed React features and bugfixes earlier for your users and at your own release schedule, similar to how React Native has been doing it for the last few years. The downside is that you would take on additional responsibility to review which React commits are being pulled in and communicate to your users which React changes are included with your releases.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"If you’re a framework author and want to try this approach, please get in touch with us.\"}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"announcing-breaking-changes-and-new-features-early\",\"children\":\"Announcing breaking changes and new features early \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Canary releases represent our best guess of what will go into the next stable React release at any given time.\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Traditionally, we’ve only announced breaking changes at the \",[\"$r\",\"em\",null,{\"children\":\"end\"}],\" of the release cycle (when doing a major release). Now that Canary releases are an officially supported way to consume React, we plan to shift towards announcing breaking changes and significant new features \",[\"$r\",\"em\",null,{\"children\":\"as they land\"}],\" in Canaries. For example, if we merge a breaking change that will go out in a Canary, we will write a post about it on the React blog, including codemods and migration instructions if necessary. Then, if you’re a framework author cutting a major release that updates the pinned React canary to include that change, you can link to our blog post from your release notes. Finally, when a stable major version of React is ready, we will link to those already published blog posts, which we hope will help our team make progress faster.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"We plan to document APIs as they land in Canaries—even if these APIs are not yet available outside of them. APIs that are only available in Canaries will be marked with a special note on the corresponding pages. This will include APIs like \",[\"$r\",\"a\",null,{\"href\":\"https://github.com/reactjs/rfcs/pull/229\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"use\"}]}],\", and some others (like \",[\"$r\",\"code\",null,{\"children\":\"cache\"}],\" and \",[\"$r\",\"code\",null,{\"children\":\"createServerContext\"}],\") which we’ll send RFCs for.\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"canaries-must-be-pinned\",\"children\":\"Canaries must be pinned \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"If you decide to adopt the Canary workflow for your app or framework, make sure you always pin the \",[\"$r\",\"em\",null,{\"children\":\"exact\"}],\" version of the Canary you’re using. Since Canaries are pre-releases, they may still include breaking changes.\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"example-react-server-components\",\"children\":\"Example: React Server Components \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"As we \",[\"$r\",\"a\",null,{\"href\":\"/blog/2023/03/22/react-labs-what-we-have-been-working-on-march-2023#react-server-components\",\"children\":\"announced in March\"}],\", the React Server Components conventions have been finalized, and we do not expect significant breaking changes related to their user-facing API contract. However, we can’t release support for React Server Components in a stable version of React yet because we are still working on several intertwined framework-only features (such as \",[\"$r\",\"a\",null,{\"href\":\"/blog/2023/03/22/react-labs-what-we-have-been-working-on-march-2023#asset-loading\",\"children\":\"asset loading\"}],\") and expect more breaking changes there.\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"This means that React Server Components are ready to be adopted by frameworks. However, until the next major React release, the only way for a framework to adopt them is to ship a pinned Canary version of React. (To avoid bundling two copies of React, frameworks that wish to do this would need to enforce resolution of \",[\"$r\",\"code\",null,{\"children\":\"react\"}],\" and \",[\"$r\",\"code\",null,{\"children\":\"react-dom\"}],\" to the pinned Canary they ship with their framework, and explain that to their users. As an example, this is what Next.js App Router does.)\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"testing-libraries-against-both-stable-and-canary-versions\",\"children\":\"Testing libraries against both Stable and Canary versions \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"We do not expect library authors to test every single Canary release since it would be prohibitively difficult. However, just as when we \",[\"$r\",\"a\",null,{\"href\":\"https://legacy.reactjs.org/blog/2019/10/22/react-release-channels.html\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"originally introduced the different React pre-release channels three years ago\"}],\", we encourage libraries to run tests against \",[\"$r\",\"em\",null,{\"children\":\"both\"}],\" the latest Stable and latest Canary versions. If you see a change in behavior that wasn’t announced, please file a bug in the React repository so that we can help diagnose it. We expect that as this practice becomes widely adopted, it will reduce the amount of effort necessary to upgrade libraries to new major versions of React, since accidental regressions would be found as they land.\"]}],\"\\n\",[\"$r\",\"Note\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"Strictly speaking, Canary is not a \",[\"$r\",\"em\",null,{\"children\":\"new\"}],\" release channel—it used to be called Next. However, we’ve decided to rename it to avoid confusion with Next.js. We’re announcing it as a \",[\"$r\",\"em\",null,{\"children\":\"new\"}],\" release channel to communicate the new expectations, such as Canaries being an officially supported way to use React.\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"stable-releases-work-like-before\",\"children\":\"Stable releases work like before \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"We are not introducing any changes to stable React releases.\"}]]}]]","meta":{"title":"React Canaries: Enabling Incremental Feature Rollout Outside Meta","author":"Dan Abramov, Sophie Alpert, Rick Hanlon, Sebastian Markbage, and Andrew Clark","date":"2023/05/03","description":"We'd like to offer the React community an option to adopt individual new features as soon as their design is close to final, before they're released in a stable version--similar to how Meta has long used bleeding-edge versions of React internally. We are introducing a new officially supported [Canary release channel](/community/versioning-policy#canary-channel). It lets curated setups like frameworks decouple adoption of individual React features from the React release schedule."},"languages":null},"__N_SSG":true}