import{r as j,v as F,Q as O,g as E,o as P,c as R,a as l,k as p,A as f,u as o,t as w,F as $}from"./vue.CliZxonC.js";import{s as U}from"./utils.CjPqU7dS.js";import{t as k}from"./configurable.C7TV9RQd.js";import{w as G}from"./index._Xu8Z1If.js";import"./js-yaml.mbYHt68G.js";import"./index.DjB8f8Dt.js";import"./filters.DuwCkQ5C.js";function v(a){return new Promise((e,r)=>{a.oncomplete=a.onsuccess=()=>e(a.result),a.onabort=a.onerror=()=>r(a.error)})}function I(a,e){const r=indexedDB.open(a);r.onupgradeneeded=()=>r.result.createObjectStore(e);const u=v(r);return(m,s)=>u.then(d=>s(d.transaction(e,m).objectStore(e)))}let b;function c(){return b||(b=I("keyval-store","keyval")),b}function K(a,e=c()){return e("readonly",r=>v(r.get(a)))}function M(a,e,r=c()){return r("readwrite",u=>(u.put(e,a),v(u.transaction)))}function W(a,e,r=c()){return r("readwrite",u=>new Promise((m,s)=>{u.get(a).onsuccess=function(){try{u.put(e(this.result),a),m(v(u.transaction))}catch(d){s(d)}}}))}function Y(a,e=c()){return e("readwrite",r=>(r.delete(a),v(r.transaction)))}function g(a,e,r={}){const{flush:u="pre",deep:m=!0,shallow:s=!1,onError:d=i=>{console.error(i)},writeDefaults:V=!0}=r,t=j(!1),n=(s?F:j)(e),y=k(e);async function B(){try{const i=await K(a);i===void 0?y!=null&&V&&await M(a,y):n.value=i}catch(i){d(i)}t.value=!0}B();async function S(){try{n.value==null?await Y(a):await W(a,()=>O(n.value))}catch(i){d(i)}}const{pause:D,resume:z}=G(n,()=>S(),{flush:u,deep:m});async function A(i){D(),n.value=i,await S(),z()}return{set:A,isFinished:t,data:n}}const C={lang:"json"},Q={lang:"json"},x="vue-use-idb-keyval",q=E({__name:"demo.client",setup(a){const e=g(`${x}-object`,{name:"Banana",color:"Yellow",size:"Medium",count:0}),r=U(e.data),u=g(`${x}-string`,"foobar"),m=u,s=g(`${x}-array`,["foo","bar","baz"]),d=U(s.data);return(V,t)=>(P(),R($,null,[t[8]||(t[8]=l("h5",null,"Object",-1)),p(l("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>o(e).data.value.name=n),type:"text"},null,512),[[f,o(e).data.value.name]]),p(l("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>o(e).data.value.color=n),type:"text"},null,512),[[f,o(e).data.value.color]]),p(l("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>o(e).data.value.size=n),type:"text"},null,512),[[f,o(e).data.value.size]]),p(l("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>o(e).data.value.count=n),type:"range",min:"0",step:"0.01",max:"1000"},null,512),[[f,o(e).data.value.count,void 0,{number:!0}]]),l("pre",C,w(o(r)),1),t[9]||(t[9]=l("br",null,null,-1)),t[10]||(t[10]=l("h5",null,"String",-1)),p(l("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>o(u).data.value=n),type:"text"},null,512),[[f,o(u).data.value]]),l("pre",null,w(o(m)),1),t[11]||(t[11]=l("br",null,null,-1)),t[12]||(t[12]=l("h5",null,"Array",-1)),p(l("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>o(s).data.value[0]=n),type:"text"},null,512),[[f,o(s).data.value[0]]]),p(l("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>o(s).data.value[1]=n),type:"text"},null,512),[[f,o(s).data.value[1]]]),p(l("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>o(s).data.value[2]=n),type:"text"},null,512),[[f,o(s).data.value[2]]]),l("pre",Q,w(o(d)),1)],64))}});export{q as default};
