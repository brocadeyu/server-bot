import{c as y}from"./configurable.C7TV9RQd.js";import{u as h}from"./index.C2bU4x7s.js";import{u as w}from"./index.xg-CtWbU.js";import{u as P}from"./index.BZhC5QYF.js";import{r as v,f as o}from"./vue.CliZxonC.js";function x(f={}){const{navigator:t=y,requestPermissions:d=!1,constraints:m={audio:!0,video:!0},onUpdated:r}=f,i=v([]),p=o(()=>i.value.filter(e=>e.kind==="videoinput")),D=o(()=>i.value.filter(e=>e.kind==="audioinput")),g=o(()=>i.value.filter(e=>e.kind==="audiooutput")),u=P(()=>t&&t.mediaDevices&&t.mediaDevices.enumerateDevices),a=v(!1);let s;async function n(){u.value&&(i.value=await t.mediaDevices.enumerateDevices(),r==null||r(i.value),s&&(s.getTracks().forEach(e=>e.stop()),s=null))}async function c(){if(!u.value)return!1;if(a.value)return!0;const{state:e,query:k}=w("camera",{controls:!0});if(await k(),e.value!=="granted"){let l=!0;try{s=await t.mediaDevices.getUserMedia(m)}catch{s=null,l=!1}n(),a.value=l}else a.value=!0;return a.value}return u.value&&(d&&c(),h(t.mediaDevices,"devicechange",n),n()),{devices:i,ensurePermissions:c,permissionGranted:a,videoInputs:p,audioInputs:D,audioOutputs:g,isSupported:u}}export{x as u};
