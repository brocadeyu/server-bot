import{d as h,t as W}from"./configurable.C7TV9RQd.js";import{t as C}from"./index.BaP1Ew-9.js";import{w as F}from"./index._Xu8Z1If.js";import{u as N}from"./index.C2bU4x7s.js";import{v,r as x,M as H}from"./vue.CliZxonC.js";const c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d="__vueuse_ssr_handlers__",R=K();function K(){return d in c||(c[d]=c[d]||{}),c[d]}function L(e,s){return R[e]||s}function P(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const q={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},O="vueuse-storage";function X(e,s,n,g={}){const{flush:E="pre",deep:_=!0,listenToStorageChanges:A=!0,writeDefaults:J=!0,mergeDefaults:p=!1,shallow:z,window:u=h,eventFilter:D,onError:m=t=>{console.error(t)},initOnMounted:S}=g,i=(z?v:x)(typeof s=="function"?s():s);if(!n)try{n=L("getDefaultStorage",()=>{var t;return(t=h)==null?void 0:t.localStorage})()}catch(t){m(t)}if(!n)return i;const o=W(s),w=P(o),l=g.serializer??q[w],{pause:M,resume:y}=F(i,()=>T(i.value),{flush:E,deep:_,eventFilter:D});u&&A&&C(()=>{n instanceof Storage?N(u,"storage",f):N(u,O,j),S&&f()}),S||f();function b(t,r){if(u){const a={key:e,oldValue:t,newValue:r,storageArea:n};u.dispatchEvent(n instanceof Storage?new StorageEvent("storage",a):new CustomEvent(O,{detail:a}))}}function T(t){try{const r=n.getItem(e);if(t==null)b(r,null),n.removeItem(e);else{const a=l.write(t);r!==a&&(n.setItem(e,a),b(r,a))}}catch(r){m(r)}}function V(t){const r=t?t.newValue:n.getItem(e);if(r==null)return J&&o!=null&&n.setItem(e,l.write(o)),o;if(!t&&p){const a=l.read(r);return typeof p=="function"?p(a,o):w==="object"&&!Array.isArray(a)?{...o,...a}:a}else return typeof r!="string"?r:l.read(r)}function f(t){if(!(t&&t.storageArea!==n)){if(t&&t.key==null){i.value=o;return}if(!(t&&t.key!==e)){M();try{(t==null?void 0:t.newValue)!==l.write(i.value)&&(i.value=V(t))}catch(r){m(r)}finally{t?H(y):y()}}}}function j(t){f(t.detail)}return i}export{L as g,X as u};
